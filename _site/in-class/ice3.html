<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muhamad Ameer Noor">
<meta name="dcterms.date" content="2023-11-25">

<title>ISSS624 - Applied Geospatial Analytics - In-class Exercise 3 - Calibrating Spatial Interaction Models with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624 - Applied Geospatial Analytics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../hands-on/hoe1.html" rel="" target="">
 <span class="dropdown-text">1A - Geospatial Data Wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe1-choropleth.html" rel="" target="">
 <span class="dropdown-text">1B - Choropleth Mapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe2-spatialweight.html" rel="" target="">
 <span class="dropdown-text">2A - Spatial Weights and Application</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe2-globalautocor.html" rel="" target="">
 <span class="dropdown-text">2B - Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe2-localautocor.html" rel="" target="">
 <span class="dropdown-text">2C - Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe3.html" rel="" target="">
 <span class="dropdown-text">3 - Flow Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../hands-on/hoe4.html" rel="" target="">
 <span class="dropdown-text">4 - Geographically Weighted Regression (GWR)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../in-class/ice1.html" rel="" target="">
 <span class="dropdown-text">1 - Preparing The Data Flow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/ice2.html" rel="" target="">
 <span class="dropdown-text">2 - sfdep for Spatial Weights, GLSA &amp; EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/ice3.html" rel="" target="">
 <span class="dropdown-text">3 - Calibrating Spatial Interaction Models with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../in-class/ice4.html" rel="" target="">
 <span class="dropdown-text">4 - GDS and SIM with R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../take-home/the1.html" rel="" target="">
 <span class="dropdown-text">1 - Geospatial Analytics for Public Goods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../take-home/the2.html" rel="" target="">
 <span class="dropdown-text">2 - Applied Spatial Interaction Models (WIP)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/muhamad-ameer-noor/" rel="" target=""><i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=TS_ilSMAAAAJ&amp;hl=en&amp;oi=ao" rel="" target=""><i class="bi bi-book" role="img" aria-label="Google Scholar">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation"><span class="header-section-number">2</span> Preparation</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="header-section-number">3</span> Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#distance-matrix-computation" id="toc-distance-matrix-computation" class="nav-link" data-scroll-target="#distance-matrix-computation"><span class="header-section-number">3.1</span> Distance Matrix Computation</a></li>
  <li><a href="#labelling-column-and-row-heanders-of-a-distance-matrix" id="toc-labelling-column-and-row-heanders-of-a-distance-matrix" class="nav-link" data-scroll-target="#labelling-column-and-row-heanders-of-a-distance-matrix"><span class="header-section-number">3.2</span> Labelling column and row heanders of a distance matrix</a></li>
  <li><a href="#pivoting-distance-value-by-subzone_c" id="toc-pivoting-distance-value-by-subzone_c" class="nav-link" data-scroll-target="#pivoting-distance-value-by-subzone_c"><span class="header-section-number">3.3</span> Pivoting distance value by SUBZONE_C</a></li>
  <li><a href="#updating-intra-zonal-distances" id="toc-updating-intra-zonal-distances" class="nav-link" data-scroll-target="#updating-intra-zonal-distances"><span class="header-section-number">3.4</span> Updating intra-zonal distances</a></li>
  </ul></li>
  <li><a href="#feature-engineering---preparing-flow-data" id="toc-feature-engineering---preparing-flow-data" class="nav-link" data-scroll-target="#feature-engineering---preparing-flow-data"><span class="header-section-number">4</span> Feature Engineering - Preparing flow data</a>
  <ul class="collapse">
  <li><a href="#separating-intra-flow-from-passenger-volume-df" id="toc-separating-intra-flow-from-passenger-volume-df" class="nav-link" data-scroll-target="#separating-intra-flow-from-passenger-volume-df"><span class="header-section-number">4.1</span> Separating intra-flow from passenger volume df</a></li>
  <li><a href="#combining-passenger-volume-data-with-distance-value" id="toc-combining-passenger-volume-data-with-distance-value" class="nav-link" data-scroll-target="#combining-passenger-volume-data-with-distance-value"><span class="header-section-number">4.2</span> Combining passenger volume data with distance value</a></li>
  </ul></li>
  <li><a href="#feature-engineering---preparing-origin-and-destination-attributes" id="toc-feature-engineering---preparing-origin-and-destination-attributes" class="nav-link" data-scroll-target="#feature-engineering---preparing-origin-and-destination-attributes"><span class="header-section-number">5</span> Feature Engineering - Preparing Origin and Destination Attributes</a>
  <ul class="collapse">
  <li><a href="#importing-population-data" id="toc-importing-population-data" class="nav-link" data-scroll-target="#importing-population-data"><span class="header-section-number">5.1</span> Importing population data</a></li>
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling"><span class="header-section-number">5.2</span> Geospatial data wrangling</a></li>
  <li><a href="#preparing-origin-destination-attribute" id="toc-preparing-origin-destination-attribute" class="nav-link" data-scroll-target="#preparing-origin-destination-attribute"><span class="header-section-number">5.3</span> Preparing origin &amp; destination attribute</a></li>
  </ul></li>
  <li><a href="#calibrating-spatial-interaction-models" id="toc-calibrating-spatial-interaction-models" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models"><span class="header-section-number">6</span> Calibrating Spatial Interaction Models</a>
  <ul class="collapse">
  <li><a href="#importing-the-modelling-data" id="toc-importing-the-modelling-data" class="nav-link" data-scroll-target="#importing-the-modelling-data"><span class="header-section-number">6.1</span> Importing the modelling data</a></li>
  <li><a href="#visualising-the-dependent-variable" id="toc-visualising-the-dependent-variable" class="nav-link" data-scroll-target="#visualising-the-dependent-variable"><span class="header-section-number">6.2</span> Visualising the dependent variable</a></li>
  <li><a href="#checking-for-variables-with-zero-values" id="toc-checking-for-variables-with-zero-values" class="nav-link" data-scroll-target="#checking-for-variables-with-zero-values"><span class="header-section-number">6.3</span> Checking for variables with zero values</a></li>
  <li><a href="#unconstrained-spatial-interaction-model" id="toc-unconstrained-spatial-interaction-model" class="nav-link" data-scroll-target="#unconstrained-spatial-interaction-model"><span class="header-section-number">6.4</span> Unconstrained Spatial Interaction Model</a></li>
  <li><a href="#r-squared-function" id="toc-r-squared-function" class="nav-link" data-scroll-target="#r-squared-function"><span class="header-section-number">6.5</span> R-squared function</a></li>
  <li><a href="#origin-production-constrained-sim" id="toc-origin-production-constrained-sim" class="nav-link" data-scroll-target="#origin-production-constrained-sim"><span class="header-section-number">6.6</span> Origin (Production) constrained SIM</a></li>
  <li><a href="#destination-constrained" id="toc-destination-constrained" class="nav-link" data-scroll-target="#destination-constrained"><span class="header-section-number">6.7</span> Destination constrained</a></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained"><span class="header-section-number">6.8</span> Doubly constrained</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">6.9</span> Model comparison</a></li>
  <li><a href="#visualising-fitted" id="toc-visualising-fitted" class="nav-link" data-scroll-target="#visualising-fitted"><span class="header-section-number">6.10</span> Visualising fitted</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In-class Exercise 3 - Calibrating Spatial Interaction Models with R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Muhamad Ameer Noor </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 25, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 14, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/ice3.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Illustration</figcaption>
</figure>
</div>
<section id="overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Overview</h1>
<div class="notebox lightbulb">
<p>Spatial Interaction Models (SIMs), developed by Alan Wilson in the late 1960s, estimate flows between spatial entities. Traditionally, there are four types: Unconstrained, Production-constrained, Attraction-constrained, and Doubly-constrained. This chapter explores hands-on calibration of SIM using Ordinary Least Square (OLS), log-normal, Poisson, and negative binomial regression methods. Calibration involves adjusting parameters to align model estimates with observed data, facilitated by computer iterative processes. The exercise focuses on calibrating SIM to understand factors influencing public bus passenger flows during the morning peak in Singapore.</p>
</div>
<p>In this exercise, we are going to calibrate SIM to determine factors affecting the public bus passenger flows during the morning peak in Singapore.</p>
</section>
<section id="preparation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Preparation</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">import the library</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">import the data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp, DT, performance, reshape2, units, tidyverse, patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><code>tmap</code> for creating thematic maps.</li>
<li><code>sf</code> for importing, integrating, processing and transforming geospatial data.</li>
<li><code>sp</code> is for storing special polygon dataframe in which the processes will be more efficient with</li>
<li><code>tidyverse</code> for importing, integrating, wrangling and visualising data.</li>
<li><code>performance</code> for checking model performance.</li>
<li><code>reshape2</code> for doing certain processes in which it’s more efficient compared to tidyverse (it’s an old package).</li>
<li><code>patchwork</code> for arranging several charts in one display.</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Continuing from the Hands-on Exercise 3, this exercise utilizes two key datasets:</p>
<ul>
<li><em>od_data.rds</em>: Weekday morning peak passenger flows at the planning subzone level.</li>
<li><em>mpsz.rds</em>: URA Master Plan 2019 Planning Subzone boundaries in simple feature tibble data frame format.</li>
</ul>
<p>Additionally, an attribute data file named <em>pop.csv</em> will be used as well.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../data/rds/mpsz.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mpsz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21 / Singapore TM
First 10 features:
                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N
1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION
2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION
3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION
4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION
5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION
6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION
7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION
8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION
9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION
10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION
   REGION_C                       geometry
1        CR MULTIPOLYGON (((33222.98 29...
2        CR MULTIPOLYGON (((28481.45 30...
3        CR MULTIPOLYGON (((28087.34 30...
4        WR MULTIPOLYGON (((14557.7 304...
5        CR MULTIPOLYGON (((29542.53 31...
6        CR MULTIPOLYGON (((35279.55 30...
7        WR MULTIPOLYGON (((15772.59 21...
8        WR MULTIPOLYGON (((19843.41 21...
9        CR MULTIPOLYGON (((30870.53 22...
10       CR MULTIPOLYGON (((26879.04 26...</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Wrangling</h1>
<section id="distance-matrix-computation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="distance-matrix-computation"><span class="header-section-number">3.1</span> Distance Matrix Computation</h2>
<p>Notice that the previous imported data is a sf tibble dataframe object class. Computing distance can take longer with the <code>sf</code> based data. To make it faster, use <em>Spatial Polygons Dataframe</em>. Conver the data using <a href="https://r-spatial.github.io/sf/reference/coerce-methods.html"><code>as.Spatial()</code></a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(mpsz, <span class="st">"Spatial"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mpsz_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 332 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 6
names       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C 
min values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR 
max values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR </code></pre>
</div>
</div>
<p>Next, <a href="https://www.rdocumentation.org/packages/sp/versions/2.1-1/topics/spDistsN1"><code>spDists()</code></a> of <code>sp</code> package will be used to compute the Euclidean distance between the centroids of the planning subzones.</p>
<div class="notebox lightbulb">
<p><strong>Do you know why the distance is calculated between two centroids of a pair of spatial polygons?</strong> The distance between two centroids of spatial polygons is commonly calculated as a measure of proximity or spatial relationship between the polygons. This approach simplifies spatial analysis by representing each polygon as a single point (centroid), providing a straightforward measure of the overall spatial separation or closeness between the features.</p>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate generic R Matrix object</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(mpsz_sp, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the output</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]
 [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836
 [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523
 [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146
 [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017
 [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916
 [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082
 [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000
 [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082
 [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930
[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391
           [,8]      [,9]     [,10]
 [1,] 14960.942  7515.256  6391.342
 [2,] 12749.410  7934.808  4975.002
 [3,] 12477.871  7649.776  4669.295
 [4,] 11284.279 18427.503 15469.566
 [5,] 13336.042  7801.616  5226.873
 [6,] 16281.453  8403.896  7707.091
 [7,]  5606.082 14810.930 13111.391
 [8,]     0.000  9472.024  8575.490
 [9,]  9472.024     0.000  3780.800
[10,]  8575.490  3780.800     0.000</code></pre>
</div>
</div>
<p>Output of <em>dist</em> is a matrix object class of R that does not have any column headers and row headers are not labeled with the planning subzone codes. Therefore the next step is to label it.</p>
</section>
<section id="labelling-column-and-row-heanders-of-a-distance-matrix" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="labelling-column-and-row-heanders-of-a-distance-matrix"><span class="header-section-number">3.2</span> Labelling column and row heanders of a distance matrix</h2>
<p>Create list of the headers</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sz_names <span class="ot">&lt;-</span> mpsz<span class="sc">$</span>SUBZONE_C</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>sz_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "MESZ01" "RVSZ05" "SRSZ01" "WISZ01" "MUSZ02" "MPSZ05" "WISZ03" "WISZ02"
  [9] "SISZ02" "SISZ01" "BMSZ17" "DTSZ10" "SVSZ01" "BMSZ01" "BMSZ15" "DTSZ09"
 [17] "BMSZ16" "BMSZ14" "DTSZ07" "DTSZ08" "BMSZ11" "BMSZ13" "QTSZ14" "DTSZ11"
 [25] "BMSZ05" "BMSZ12" "BMSZ02" "OTSZ03" "DTSZ04" "DTSZ05" "OTSZ04" "BMSZ10"
 [33] "DTSZ12" "BMSZ04" "DTSZ06" "MSSZ01" "OTSZ01" "SRSZ03" "BMSZ08" "BMSZ03"
 [41] "BMSZ07" "BMSZ09" "SRSZ02" "QTSZ13" "QTSZ07" "QTSZ12" "BMSZ06" "QTSZ04"
 [49] "RCSZ06" "RCSZ03" "QTSZ08" "KLSZ05" "QTSZ03" "QTSZ10" "TNSZ03" "NTSZ04"
 [57] "CLSZ08" "NTSZ05" "BDSZ07" "CLSZ07" "PNSZ05" "JESZ11" "NTSZ01" "KLSZ04"
 [65] "MPSZ02" "ORSZ02" "NTSZ06" "RCSZ02" "PNSZ04" "DTSZ03" "MUSZ03" "RVSZ04"
 [73] "DTSZ02" "QTSZ06" "RVSZ03" "QTSZ15" "MUSZ01" "DTSZ01" "RCSZ10" "RVSZ02"
 [81] "MPSZ04" "QTSZ11" "RVSZ01" "ORSZ03" "RCSZ09" "TNSZ02" "RCSZ05" "RCSZ08"
 [89] "RCSZ07" "RCSZ04" "DTSZ13" "QTSZ05" "ORSZ01" "MPSZ03" "PNSZ01" "GLSZ01"
 [97] "JESZ07" "BLSZ01" "BTSZ06" "BDSZ03" "NVSZ04" "CLSZ02" "GLSZ02" "TPSZ07"
[105] "BDSZ04" "TPSZ02" "JESZ06" "BTSZ03" "GLSZ03" "TPSZ11" "TPSZ09" "TSSZ03"
[113] "TPSZ06" "TPSZ04" "JWSZ06" "JWSZ07" "RCSZ01" "NTSZ03" "JESZ10" "BLSZ03"
[121] "BLSZ04" "QTSZ01" "KLSZ06" "NTSZ02" "CLSZ09" "QTSZ09" "CLSZ06" "KLSZ07"
[129] "KLSZ03" "KLSZ08" "BTSZ04" "BTSZ08" "TNSZ01" "CLSZ05" "BDSZ08" "PNSZ03"
[137] "PNSZ02" "TNSZ04" "NVSZ02" "BLSZ02" "BDSZ05" "CLSZ04" "BTSZ07" "GLSZ05"
[145] "JESZ09" "JESZ08" "KLSZ02" "CLSZ03" "NVSZ03" "BDSZ06" "KLSZ01" "NVSZ01"
[153] "TSSZ02" "SGSZ06" "BSSZ03" "TMSZ03" "BKSZ03" "HGSZ09" "CBSZ01" "PLSZ02"
[161] "BKSZ02" "HGSZ06" "AMSZ03" "SGSZ04" "HGSZ01" "PRSZ07" "BPSZ06" "PRSZ05"
[169] "TMSZ01" "AMSZ02" "AMSZ01" "AMSZ06" "SGSZ02" "THSZ02" "SGSZ03" "BKSZ04"
[177] "JWSZ01" "BPSZ07" "TMSZ02" "HGSZ07" "PRSZ08" "BKSZ05" "CLSZ01" "NVSZ05"
[185] "BTSZ05" "TPSZ12" "JWSZ05" "TPSZ05" "JESZ03" "TPSZ03" "TPSZ10" "TPSZ08"
[193] "JWSZ04" "JESZ04" "TPSZ01" "BDSZ01" "JESZ02" "BKSZ09" "JWSZ09" "BDSZ02"
[201] "BTSZ01" "BTSZ02" "TMSZ05" "TMSZ04" "JWSZ02" "BKSZ08" "BKSZ06" "BKSZ07"
[209] "SGSZ07" "HGSZ08" "TSSZ01" "JESZ01" "JWSZ08" "SGSZ05" "JWSZ03" "SLSZ04"
[217] "SKSZ04" "SLSZ01" "YSSZ08" "MDSZ01" "PGSZ07" "YSSZ04" "YSSZ05" "PGSZ01"
[225] "MDSZ03" "YSSZ01" "PRSZ03" "BKSZ01" "PLSZ01" "HGSZ03" "HGSZ10" "HGSZ02"
[233] "AMSZ07" "BPSZ05" "CKSZ02" "HGSZ04" "PLSZ03" "BPSZ04" "SESZ01" "CKSZ04"
[241] "PRSZ02" "AMSZ09" "HGSZ05" "CKSZ01" "CKSZ03" "BPSZ03" "BPSZ01" "BPSZ02"
[249] "SGSZ01" "SESZ05" "AMSZ12" "AMSZ10" "PRSZ06" "AMSZ08" "PRSZ04" "CKSZ05"
[257] "SESZ02" "AMSZ11" "CHSZ01" "SESZ03" "SESZ04" "SESZ07" "SESZ06" "PGSZ04"
[265] "CKSZ06" "PRSZ01" "PGSZ03" "PGSZ05" "SKSZ03" "YSSZ06" "PGSZ02" "PGSZ06"
[273] "CCSZ01" "SBSZ06" "SBSZ07" "SBSZ08" "KLSZ09" "TSSZ04" "TSSZ05" "WCSZ03"
[281] "WCSZ02" "JESZ05" "THSZ03" "THSZ04" "THSZ01" "THSZ06" "THSZ05" "PLSZ04"
[289] "CHSZ02" "QTSZ02" "CHSZ03" "OTSZ02" "MPSZ01" "GLSZ04" "SLSZ03" "SKSZ02"
[297] "WDSZ04" "WDSZ05" "YSSZ03" "WCSZ01" "SLSZ02" "YSSZ09" "WDSZ01" "NESZ01"
[305] "SMSZ03" "YSSZ02" "WDSZ02" "WDSZ06" "SBSZ02" "SKSZ01" "SKSZ05" "WDSZ03"
[313] "SBSZ03" "WDSZ07" "SBSZ01" "WDSZ08" "SMSZ04" "SBSZ05" "LKSZ01" "SMSZ01"
[321] "SBSZ09" "SBSZ04" "SMSZ02" "WDSZ09" "PLSZ05" "MDSZ02" "YSSZ07" "BSSZ01"
[329] "AMSZ05" "AMSZ04" "BSSZ02" "TSSZ06"</code></pre>
</div>
</div>
<p>attach <code>SUBZONE_C</code> to row and column for distance matrix matching ahead</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pivoting-distance-value-by-subzone_c" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="pivoting-distance-value-by-subzone_c"><span class="header-section-number">3.3</span> Pivoting distance value by SUBZONE_C</h2>
<p>Next, pivot the distance matrix into a long table by using the row and column subzone codes using this code.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1   Var2      dist
1  MESZ01 MESZ01     0.000
2  RVSZ05 MESZ01  3926.003
3  SRSZ01 MESZ01  3939.108
4  WISZ01 MESZ01 20252.964
5  MUSZ02 MESZ01  2989.984
6  MPSZ05 MESZ01  1431.330
7  WISZ03 MESZ01 19211.836
8  WISZ02 MESZ01 14960.942
9  SISZ02 MESZ01  7515.256
10 SISZ01 MESZ01  6391.342</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Warning!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning!
</div>
</div>
<div class="callout-body-container callout-body">
<p>do not sort the data because the sequence will be broken</p>
</div>
</div>
</section>
<section id="updating-intra-zonal-distances" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="updating-intra-zonal-distances"><span class="header-section-number">3.4</span> Updating intra-zonal distances</h2>
<p>In this section, we are going to append a constant value to replace the intra-zonal distance of 0.</p>
<p>First, we will select and find out the minimum value of the distance by using <code>summary()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist        
 MESZ01 :   331   MESZ01 :   331   Min.   :  173.8  
 RVSZ05 :   331   RVSZ05 :   331   1st Qu.: 7149.5  
 SRSZ01 :   331   SRSZ01 :   331   Median :11890.0  
 WISZ01 :   331   WISZ01 :   331   Mean   :12229.4  
 MUSZ02 :   331   MUSZ02 :   331   3rd Qu.:16401.7  
 MPSZ05 :   331   MPSZ05 :   331   Max.   :49894.4  
 (Other):107906   (Other):107906                    </code></pre>
</div>
</div>
<p>The constant distant selected for intra-zones must be below the minimum distance (173.8). 50m is picked as the fix distance to be put into intra-zones distance.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>dist)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(distPair)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist      
 MESZ01 :   332   MESZ01 :   332   Min.   :   50  
 RVSZ05 :   332   RVSZ05 :   332   1st Qu.: 7097  
 SRSZ01 :   332   SRSZ01 :   332   Median :11864  
 WISZ01 :   332   WISZ01 :   332   Mean   :12193  
 MUSZ02 :   332   MUSZ02 :   332   3rd Qu.:16388  
 MPSZ05 :   332   MPSZ05 :   332   Max.   :49894  
 (Other):108232   (Other):108232                  </code></pre>
</div>
</div>
<p>notice that the minimum value has change (i.e.&nbsp;0 within-distance has changed to 50)</p>
<div class="callout callout-style-default callout-note callout-titled" title="alternative method to calculate the within-distance!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
alternative method to calculate the within-distance!
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>calculate the parameter</li>
<li>calculate the distance</li>
</ul>
</div>
</div>
<p>The code chunk below is used to rename the origin and destination fields.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below is used to save the dataframe for future use.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(distPair, <span class="st">"../data/rds/distPair.rds"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="feature-engineering---preparing-flow-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Feature Engineering - Preparing flow data</h1>
<p>The code chunk below is used import <em>od_data</em> save in Chapter 15 into R environment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../data/rds/od_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the total passenger trip between and within planning subzones by using the code chunk below. The output is all <em>flow_data</em>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DESTIN_SZ) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(MORNING_PEAK)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Use the code chunk below to display flow_data dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   ORIGIN_SZ [1]
   ORIGIN_SZ DESTIN_SZ TRIPS
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
 1 AMSZ01    AMSZ01     1866
 2 AMSZ01    AMSZ02     8726
 3 AMSZ01    AMSZ03    12598
 4 AMSZ01    AMSZ04     2098
 5 AMSZ01    AMSZ05     7718
 6 AMSZ01    AMSZ06     1631
 7 AMSZ01    AMSZ07     1308
 8 AMSZ01    AMSZ08     2261
 9 AMSZ01    AMSZ09     1526
10 AMSZ01    AMSZ10      141</code></pre>
</div>
</div>
<section id="separating-intra-flow-from-passenger-volume-df" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="separating-intra-flow-from-passenger-volume-df"><span class="header-section-number">4.1</span> Separating intra-flow from passenger volume df</h2>
<p>Code chunk below is used to add three new fields in <code>flow_data</code> dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combining-passenger-volume-data-with-distance-value" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="combining-passenger-volume-data-with-distance-value"><span class="header-section-number">4.2</span> Combining passenger volume data with distance value</h2>
<p>Before we can join <em>flow_data</em> and <em>distPair</em>, we need to convert data value type of <em>ORIGIN_SZ</em> and <em>DESTIN_SZ</em> fields of flow_data dataframe into factor data type.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_SZ)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, <code>left_join()</code> of <strong>dplyr</strong> will be used to <em>flow_data</em> dataframe and <em>distPair</em> dataframe. The output is called <em>flow_data1</em>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_SZ"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_SZ"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(flow_data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20,600 × 6
# Groups:   ORIGIN_SZ [310]
   ORIGIN_SZ DESTIN_SZ TRIPS FlowNoIntra   offset  dist
   &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 AMSZ01    AMSZ01     1866           0 0.000001   50 
 2 AMSZ01    AMSZ02     8726        8726 1         810.
 3 AMSZ01    AMSZ03    12598       12598 1        1361.
 4 AMSZ01    AMSZ04     2098        2098 1         840.
 5 AMSZ01    AMSZ05     7718        7718 1        1077.
 6 AMSZ01    AMSZ06     1631        1631 1         805.
 7 AMSZ01    AMSZ07     1308        1308 1        1799.
 8 AMSZ01    AMSZ08     2261        2261 1        2576.
 9 AMSZ01    AMSZ09     1526        1526 1        1204.
10 AMSZ01    AMSZ10      141         141 1        1418.
# ℹ 20,590 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="feature-engineering---preparing-origin-and-destination-attributes" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Feature Engineering - Preparing Origin and Destination Attributes</h1>
<section id="importing-population-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="importing-population-data"><span class="header-section-number">5.1</span> Importing population data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/aspatial/pop.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 332 × 5
   PA         SZ                     AGE7_12 AGE13_24 AGE25_64
   &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 ANG MO KIO ANG MO KIO TOWN CENTRE     310      710     2780
 2 ANG MO KIO CHENG SAN                 1140     2770    15700
 3 ANG MO KIO CHONG BOON                1010     2650    14240
 4 ANG MO KIO KEBUN BAHRU               1050     2390    12460
 5 ANG MO KIO SEMBAWANG HILLS            420     1120     3620
 6 ANG MO KIO SHANGRI-LA                 810     1920     9650
 7 ANG MO KIO TAGORE                     390     1150     4350
 8 ANG MO KIO TOWNSVILLE                 980     2000    11320
 9 ANG MO KIO YIO CHU KANG                 0        0        0
10 ANG MO KIO YIO CHU KANG EAST          260      650     2500
# ℹ 322 more rows</code></pre>
</div>
</div>
</section>
<section id="geospatial-data-wrangling" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="geospatial-data-wrangling"><span class="header-section-number">5.2</span> Geospatial data wrangling</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SZ_NAME =</span> SZ,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">SZ =</span> SUBZONE_C)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 6
$ PA       &lt;chr&gt; "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG …
$ SZ_NAME  &lt;chr&gt; "ANG MO KIO TOWN CENTRE", "CHENG SAN", "CHONG BOON", "KEBUN B…
$ AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, 6…
$ AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 326…
$ AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500, …
$ SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ06", "AMSZ07", "AMSZ05", "…</code></pre>
</div>
</div>
<div class="notebox lightbulb">
<p>this is the useful trick of how to merge two table that has different reference column.</p>
</div>
</section>
<section id="preparing-origin-destination-attribute" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="preparing-origin-destination-attribute"><span class="header-section-number">5.3</span> Preparing origin &amp; destination attribute</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing origin attribute</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing destination attribute</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># use a subzone code</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 20,600
Columns: 12
Groups: ORIGIN_SZ [310]
$ ORIGIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMS…
$ DESTIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMS…
$ TRIPS           &lt;dbl&gt; 1866, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526,…
$ FlowNoIntra     &lt;dbl&gt; 0, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526, 14…
$ offset          &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00…
$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…
$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…
$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…
$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …
$ DESTIN_AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 980, 810, 1050, 420, 390, 1190, 0, 0,…
$ DESTIN_AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2000, 1920, 2390, 1120, 1150, 3260, 0…
$ DESTIN_AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 11320, 9650, 12460, 3620, 4350, 13…</code></pre>
</div>
</div>
<div class="notebox lightbulb">
<p>Instead of doing simple join, this join use origin subzone code and destination subzone code. Having population for both is useful for the transport planning analysis as depending on the case, you might need to look at either the origin or destination population. It also conform with the general factors of geospatial flow analysis which consists of push and pull factors</p>
</div>
<p>We will called the output data file <em>SIM_data</em>. it is in rds data file format.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(flow_data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 20,600
Columns: 12
Groups: ORIGIN_SZ [310]
$ ORIGIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMS…
$ DESTIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMS…
$ TRIPS           &lt;dbl&gt; 1866, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526,…
$ FlowNoIntra     &lt;dbl&gt; 0, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526, 14…
$ offset          &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00…
$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…
$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…
$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…
$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …
$ DESTIN_AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 980, 810, 1050, 420, 390, 1190, 0, 0,…
$ DESTIN_AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2000, 1920, 2390, 1120, 1150, 3260, 0…
$ DESTIN_AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 11320, 9650, 12460, 3620, 4350, 13…</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flow_data1, <span class="st">"../data/rds/SIM_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calibrating-spatial-interaction-models" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Calibrating Spatial Interaction Models</h1>
<p>In this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.</p>
<section id="importing-the-modelling-data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="importing-the-modelling-data"><span class="header-section-number">6.1</span> Importing the modelling data</h2>
<p>Firstly, let us import the modelling data by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../data/rds/SIM_data.rds"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check the output</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 20,600
Columns: 12
Groups: ORIGIN_SZ [310]
$ ORIGIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMSZ01", "AMS…
$ DESTIN_SZ       &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ04", "AMSZ05", "AMS…
$ TRIPS           &lt;dbl&gt; 1866, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526,…
$ FlowNoIntra     &lt;dbl&gt; 0, 8726, 12598, 2098, 7718, 1631, 1308, 2261, 1526, 14…
$ offset          &lt;dbl&gt; 1e-06, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00, 1e+00…
$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…
$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…
$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…
$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …
$ DESTIN_AGE7_12  &lt;dbl&gt; 310, 1140, 1010, 980, 810, 1050, 420, 390, 1190, 0, 0,…
$ DESTIN_AGE13_24 &lt;dbl&gt; 710, 2770, 2650, 2000, 1920, 2390, 1120, 1150, 3260, 0…
$ DESTIN_AGE25_64 &lt;dbl&gt; 2780, 15700, 14240, 11320, 9650, 12460, 3620, 4350, 13…</code></pre>
</div>
</div>
</section>
<section id="visualising-the-dependent-variable" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="visualising-the-dependent-variable"><span class="header-section-number">6.2</span> Visualising the dependent variable</h2>
<p>Firstly, let us plot the distribution of the dependent variable (i.e.&nbsp;TRIPS) by using histogram method by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ice3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.</p>
<p>Next, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ice3_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that their relationship hardly resemble linear relationship.</p>
<p>On the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(dist),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ice3_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="checking-for-variables-with-zero-values" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="checking-for-variables-with-zero-values"><span class="header-section-number">6.3</span> Checking for variables with zero values</h2>
<p>Since Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.</p>
<p>In the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in <em>SIM_data</em> data frame.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      
 Length:20600       Length:20600       Min.   :     1   Min.   :     0.0  
 Class :character   Class :character   1st Qu.:    17   1st Qu.:    15.0  
 Mode  :character   Mode  :character   Median :    82   Median :    77.0  
                                       Mean   :  1035   Mean   :   867.3  
                                       3rd Qu.:   418   3rd Qu.:   382.0  
                                       Max.   :294318   Max.   :193431.0  
     offset              dist       ORIGIN_AGE7_12   ORIGIN_AGE13_24
 Min.   :0.000001   Min.   :   50   Min.   :   0.0   Min.   :    0  
 1st Qu.:1.000000   1st Qu.: 3351   1st Qu.:  50.0   1st Qu.:  100  
 Median :1.000000   Median : 6112   Median : 510.0   Median : 1140  
 Mean   :0.985874   Mean   : 6953   Mean   : 890.5   Mean   : 1958  
 3rd Qu.:1.000000   3rd Qu.: 9850   3rd Qu.:1360.0   3rd Qu.: 3010  
 Max.   :1.000000   Max.   :26136   Max.   :6340.0   Max.   :16380  
 ORIGIN_AGE25_64 DESTIN_AGE7_12   DESTIN_AGE13_24 DESTIN_AGE25_64
 Min.   :    0   Min.   :   0.0   Min.   :    0   Min.   :    0  
 1st Qu.:  730   1st Qu.:  10.0   1st Qu.:   60   1st Qu.:  620  
 Median : 5730   Median : 510.0   Median : 1090   Median : 5640  
 Mean   : 9110   Mean   : 848.1   Mean   : 1879   Mean   : 8755  
 3rd Qu.:14200   3rd Qu.:1200.0   3rd Qu.: 2920   3rd Qu.:13650  
 Max.   :74610   Max.   :6340.0   Max.   :16380   Max.   :74610  </code></pre>
</div>
</div>
<p>The print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.</p>
<p>In view of this, code chunk below will be used to replace zero values to 0.99.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE7_12)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE13_24)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE25_64)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE7_12)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE13_24)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE25_64)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># check the summary again</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      
 Length:20600       Length:20600       Min.   :     1   Min.   :     0.0  
 Class :character   Class :character   1st Qu.:    17   1st Qu.:    15.0  
 Mode  :character   Mode  :character   Median :    82   Median :    77.0  
                                       Mean   :  1035   Mean   :   867.3  
                                       3rd Qu.:   418   3rd Qu.:   382.0  
                                       Max.   :294318   Max.   :193431.0  
     offset              dist       ORIGIN_AGE7_12    ORIGIN_AGE13_24   
 Min.   :0.000001   Min.   :   50   Min.   :   0.99   Min.   :    0.99  
 1st Qu.:1.000000   1st Qu.: 3351   1st Qu.:  50.00   1st Qu.:  100.00  
 Median :1.000000   Median : 6112   Median : 510.00   Median : 1140.00  
 Mean   :0.985874   Mean   : 6953   Mean   : 890.69   Mean   : 1958.15  
 3rd Qu.:1.000000   3rd Qu.: 9850   3rd Qu.:1360.00   3rd Qu.: 3010.00  
 Max.   :1.000000   Max.   :26136   Max.   :6340.00   Max.   :16380.00  
 ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   
 Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  
 1st Qu.:  730.00   1st Qu.:  10.00   1st Qu.:   60.00   1st Qu.:  620.00  
 Median : 5730.00   Median : 510.00   Median : 1090.00   Median : 5640.00  
 Mean   : 9110.56   Mean   : 848.29   Mean   : 1879.27   Mean   : 8755.04  
 3rd Qu.:14200.00   3rd Qu.:1200.00   3rd Qu.: 2920.00   3rd Qu.:13650.00  
 Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00  </code></pre>
</div>
</div>
<p>Notice that all the 0 values have been replaced by 0.99.</p>
</section>
<section id="unconstrained-spatial-interaction-model" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="unconstrained-spatial-interaction-model"><span class="header-section-number">6.4</span> Unconstrained Spatial Interaction Model</h2>
<p>In this section, you will learn how to calibrate an unconstrained spatial interaction model by using <code>glm()</code> of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e.&nbsp;<em>ORIGIN_AGE25_64</em>) and distance between origin and destination in km (i.e.&nbsp;<em>dist</em>).</p>
<p>The code chunk used to calibrate to model is shown below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + 
    log(dist), family = poisson(link = "log"), data = SIM_data, 
    na.action = na.exclude)

Coefficients:
         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  
            10.22462               0.27766               0.02414  
           log(dist)  
            -0.71477  

Degrees of Freedom: 20599 Total (i.e. Null);  20596 Residual
Null Deviance:      88920000 
Residual Deviance: 53020000     AIC: 53150000</code></pre>
</div>
</div>
</section>
<section id="r-squared-function" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="r-squared-function"><span class="header-section-number">6.5</span> R-squared function</h2>
<p><strong>The model by default doesn’t calculate the R-Squared</strong>. In order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the R-squared of the unconstrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1971359</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_mcfadden</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Generalized Linear Regression
       R2: 0.403
  adj. R2: 0.403</code></pre>
</div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="origin-production-constrained-sim"><span class="header-section-number">6.6</span> Origin (Production) constrained SIM</h2>
<p>In this section, we will fit an origin constrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                 ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(dist),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          12.2571670  0.0033922  3613.307  &lt; 2e-16 ***
ORIGIN_SZAMSZ02       1.1210561  0.0039607   283.047  &lt; 2e-16 ***
ORIGIN_SZAMSZ03       0.6787623  0.0040295   168.446  &lt; 2e-16 ***
ORIGIN_SZAMSZ04       0.0640112  0.0045245    14.148  &lt; 2e-16 ***
ORIGIN_SZAMSZ05      -0.1272160  0.0051622   -24.644  &lt; 2e-16 ***
ORIGIN_SZAMSZ06       0.4644308  0.0046413   100.064  &lt; 2e-16 ***
ORIGIN_SZAMSZ07      -1.1499482  0.0078866  -145.811  &lt; 2e-16 ***
ORIGIN_SZAMSZ08      -0.8527902  0.0074801  -114.009  &lt; 2e-16 ***
ORIGIN_SZAMSZ09       0.2402445  0.0048966    49.064  &lt; 2e-16 ***
ORIGIN_SZAMSZ10       0.2245677  0.0045594    49.254  &lt; 2e-16 ***
ORIGIN_SZAMSZ11      -1.4591935  0.0098202  -148.591  &lt; 2e-16 ***
ORIGIN_SZAMSZ12      -1.4671448  0.0095323  -153.913  &lt; 2e-16 ***
ORIGIN_SZBDSZ01       1.1104210  0.0038840   285.900  &lt; 2e-16 ***
ORIGIN_SZBDSZ02       0.5792171  0.0044816   129.243  &lt; 2e-16 ***
ORIGIN_SZBDSZ03       1.0612529  0.0040365   262.914  &lt; 2e-16 ***
ORIGIN_SZBDSZ04       1.8040460  0.0034994   515.526  &lt; 2e-16 ***
ORIGIN_SZBDSZ05       0.8009106  0.0039583   202.337  &lt; 2e-16 ***
ORIGIN_SZBDSZ06       0.9817600  0.0040389   243.079  &lt; 2e-16 ***
ORIGIN_SZBDSZ07      -0.7463038  0.0068015  -109.726  &lt; 2e-16 ***
ORIGIN_SZBDSZ08      -0.6167593  0.0064771   -95.221  &lt; 2e-16 ***
ORIGIN_SZBKSZ01      -0.1951521  0.0055333   -35.269  &lt; 2e-16 ***
ORIGIN_SZBKSZ02       0.5446942  0.0044863   121.413  &lt; 2e-16 ***
ORIGIN_SZBKSZ03       0.8671406  0.0042070   206.117  &lt; 2e-16 ***
ORIGIN_SZBKSZ04       0.0295337  0.0051862     5.695 1.24e-08 ***
ORIGIN_SZBKSZ05       0.0431060  0.0049217     8.758  &lt; 2e-16 ***
ORIGIN_SZBKSZ06       0.1659062  0.0051313    32.332  &lt; 2e-16 ***
ORIGIN_SZBKSZ07       0.8339944  0.0039470   211.299  &lt; 2e-16 ***
ORIGIN_SZBKSZ08       0.1715636  0.0045798    37.461  &lt; 2e-16 ***
ORIGIN_SZBKSZ09       0.1323428  0.0048566    27.250  &lt; 2e-16 ***
ORIGIN_SZBLSZ01      -1.1811625  0.0105831  -111.608  &lt; 2e-16 ***
ORIGIN_SZBLSZ02      -1.9022840  0.0157452  -120.817  &lt; 2e-16 ***
ORIGIN_SZBLSZ03      -3.1788948  0.0356395   -89.196  &lt; 2e-16 ***
ORIGIN_SZBLSZ04      -1.9384600  0.0190190  -101.922  &lt; 2e-16 ***
ORIGIN_SZBMSZ01       0.0422896  0.0044140     9.581  &lt; 2e-16 ***
ORIGIN_SZBMSZ02      -1.1557595  0.0061560  -187.744  &lt; 2e-16 ***
ORIGIN_SZBMSZ03      -0.4645742  0.0050812   -91.430  &lt; 2e-16 ***
ORIGIN_SZBMSZ04      -0.0188804  0.0044368    -4.255 2.09e-05 ***
ORIGIN_SZBMSZ05      -1.2948812  0.0067113  -192.940  &lt; 2e-16 ***
ORIGIN_SZBMSZ06      -1.8317797  0.0106920  -171.323  &lt; 2e-16 ***
ORIGIN_SZBMSZ07      -0.3965908  0.0048890   -81.120  &lt; 2e-16 ***
ORIGIN_SZBMSZ08      -0.4426615  0.0048873   -90.574  &lt; 2e-16 ***
ORIGIN_SZBMSZ09      -1.1521247  0.0064125  -179.667  &lt; 2e-16 ***
ORIGIN_SZBMSZ10      -1.3498831  0.0071277  -189.386  &lt; 2e-16 ***
ORIGIN_SZBMSZ11      -0.7587856  0.0056716  -133.787  &lt; 2e-16 ***
ORIGIN_SZBMSZ12      -1.0124247  0.0075870  -133.441  &lt; 2e-16 ***
ORIGIN_SZBMSZ13      -0.0326607  0.0048100    -6.790 1.12e-11 ***
ORIGIN_SZBMSZ14      -0.5068776  0.0056569   -89.603  &lt; 2e-16 ***
ORIGIN_SZBMSZ15      -0.2701344  0.0051561   -52.391  &lt; 2e-16 ***
ORIGIN_SZBMSZ16      -1.3017559  0.0066844  -194.747  &lt; 2e-16 ***
ORIGIN_SZBMSZ17      -1.7000441  0.0099996  -170.011  &lt; 2e-16 ***
ORIGIN_SZBPSZ01       0.2669088  0.0048127    55.460  &lt; 2e-16 ***
ORIGIN_SZBPSZ02       0.3025537  0.0052798    57.304  &lt; 2e-16 ***
ORIGIN_SZBPSZ03       0.5456762  0.0049082   111.177  &lt; 2e-16 ***
ORIGIN_SZBPSZ04       0.6200281  0.0043234   143.411  &lt; 2e-16 ***
ORIGIN_SZBPSZ05       0.7092747  0.0040010   177.275  &lt; 2e-16 ***
ORIGIN_SZBPSZ06      -1.0266164  0.0074091  -138.561  &lt; 2e-16 ***
ORIGIN_SZBPSZ07      -0.7883886  0.0071684  -109.981  &lt; 2e-16 ***
ORIGIN_SZBSSZ01       0.0206846  0.0046777     4.422 9.78e-06 ***
ORIGIN_SZBSSZ02       0.2422614  0.0043750    55.374  &lt; 2e-16 ***
ORIGIN_SZBSSZ03       0.2541403  0.0042319    60.053  &lt; 2e-16 ***
ORIGIN_SZBTSZ01       0.0435329  0.0046547     9.353  &lt; 2e-16 ***
ORIGIN_SZBTSZ02      -1.0024988  0.0067690  -148.101  &lt; 2e-16 ***
ORIGIN_SZBTSZ03      -0.2062217  0.0050780   -40.611  &lt; 2e-16 ***
ORIGIN_SZBTSZ04      -0.9025837  0.0087625  -103.006  &lt; 2e-16 ***
ORIGIN_SZBTSZ05      -1.6253102  0.0096448  -168.516  &lt; 2e-16 ***
ORIGIN_SZBTSZ06      -0.8481418  0.0065977  -128.551  &lt; 2e-16 ***
ORIGIN_SZBTSZ07      -2.0293639  0.0104315  -194.541  &lt; 2e-16 ***
ORIGIN_SZBTSZ08      -1.2640980  0.0079299  -159.409  &lt; 2e-16 ***
ORIGIN_SZCBSZ01      -1.6755337  0.0461410   -36.313  &lt; 2e-16 ***
ORIGIN_SZCCSZ01      -1.6769586  0.0118018  -142.093  &lt; 2e-16 ***
ORIGIN_SZCHSZ01      -1.0913429  0.0099165  -110.053  &lt; 2e-16 ***
ORIGIN_SZCHSZ02      -0.4515900  0.0068723   -65.712  &lt; 2e-16 ***
ORIGIN_SZCHSZ03       0.4941486  0.0051649    95.675  &lt; 2e-16 ***
ORIGIN_SZCKSZ01       0.4641763  0.0043433   106.873  &lt; 2e-16 ***
ORIGIN_SZCKSZ02       0.9709837  0.0043841   221.477  &lt; 2e-16 ***
ORIGIN_SZCKSZ03       0.9650023  0.0039913   241.778  &lt; 2e-16 ***
ORIGIN_SZCKSZ04       1.3772720  0.0041024   335.723  &lt; 2e-16 ***
ORIGIN_SZCKSZ05       1.1398267  0.0046545   244.887  &lt; 2e-16 ***
ORIGIN_SZCKSZ06       1.1809132  0.0047393   249.174  &lt; 2e-16 ***
ORIGIN_SZCLSZ01      -0.2624247  0.0060463   -43.403  &lt; 2e-16 ***
ORIGIN_SZCLSZ02      -1.5835307  0.0111998  -141.389  &lt; 2e-16 ***
ORIGIN_SZCLSZ03      -0.6652855  0.0063921  -104.080  &lt; 2e-16 ***
ORIGIN_SZCLSZ04       0.7305042  0.0039999   182.631  &lt; 2e-16 ***
ORIGIN_SZCLSZ05      -1.7396773  0.0113460  -153.329  &lt; 2e-16 ***
ORIGIN_SZCLSZ06       0.9151137  0.0037622   243.242  &lt; 2e-16 ***
ORIGIN_SZCLSZ07      -0.1290281  0.0047741   -27.027  &lt; 2e-16 ***
ORIGIN_SZCLSZ08       0.2829244  0.0053130    53.252  &lt; 2e-16 ***
ORIGIN_SZCLSZ09      -1.7012515  0.0141617  -120.131  &lt; 2e-16 ***
ORIGIN_SZDTSZ01      -1.8152505  0.0079113  -229.451  &lt; 2e-16 ***
ORIGIN_SZDTSZ02      -1.7155257  0.0074197  -231.212  &lt; 2e-16 ***
ORIGIN_SZDTSZ03      -2.7298066  0.0134982  -202.235  &lt; 2e-16 ***
ORIGIN_SZDTSZ04      -4.8769923  0.1768059   -27.584  &lt; 2e-16 ***
ORIGIN_SZDTSZ05      -3.1780851  0.0248945  -127.662  &lt; 2e-16 ***
ORIGIN_SZDTSZ06      -2.9788812  0.0184579  -161.388  &lt; 2e-16 ***
ORIGIN_SZDTSZ07      -2.0587285  0.0234708   -87.715  &lt; 2e-16 ***
ORIGIN_SZDTSZ08      -2.6019045  0.0120040  -216.753  &lt; 2e-16 ***
ORIGIN_SZDTSZ09      -3.1135675  0.0238668  -130.456  &lt; 2e-16 ***
ORIGIN_SZDTSZ10      -2.4195997  0.0126801  -190.819  &lt; 2e-16 ***
ORIGIN_SZDTSZ11      -2.4191860  0.0124179  -194.815  &lt; 2e-16 ***
ORIGIN_SZDTSZ12      -3.4776345  0.0258344  -134.613  &lt; 2e-16 ***
ORIGIN_SZDTSZ13      -2.4433938  0.0138218  -176.779  &lt; 2e-16 ***
ORIGIN_SZGLSZ01      -1.3115168  0.0077080  -170.150  &lt; 2e-16 ***
ORIGIN_SZGLSZ02       0.2729653  0.0043544    62.687  &lt; 2e-16 ***
ORIGIN_SZGLSZ03       0.2478109  0.0043346    57.171  &lt; 2e-16 ***
ORIGIN_SZGLSZ04       1.0057872  0.0036747   273.708  &lt; 2e-16 ***
ORIGIN_SZGLSZ05       0.7071623  0.0038731   182.582  &lt; 2e-16 ***
ORIGIN_SZHGSZ01       0.3007625  0.0042706    70.427  &lt; 2e-16 ***
ORIGIN_SZHGSZ02       0.6580609  0.0041215   159.667  &lt; 2e-16 ***
ORIGIN_SZHGSZ03       0.3815122  0.0044541    85.655  &lt; 2e-16 ***
ORIGIN_SZHGSZ04       1.0310727  0.0038238   269.645  &lt; 2e-16 ***
ORIGIN_SZHGSZ05       1.3472438  0.0037637   357.953  &lt; 2e-16 ***
ORIGIN_SZHGSZ06      -0.0009918  0.0047715    -0.208    0.835    
ORIGIN_SZHGSZ07       0.6781934  0.0040469   167.584  &lt; 2e-16 ***
ORIGIN_SZHGSZ08       0.2693682  0.0046362    58.101  &lt; 2e-16 ***
ORIGIN_SZHGSZ09      -0.3544696  0.0059698   -59.377  &lt; 2e-16 ***
ORIGIN_SZHGSZ10      -3.5662703  0.0406525   -87.726  &lt; 2e-16 ***
ORIGIN_SZJESZ01       0.4528664  0.0044004   102.914  &lt; 2e-16 ***
ORIGIN_SZJESZ02       0.3210652  0.0044028    72.923  &lt; 2e-16 ***
ORIGIN_SZJESZ03       0.3063115  0.0046508    65.862  &lt; 2e-16 ***
ORIGIN_SZJESZ04      -0.7940775  0.0072483  -109.553  &lt; 2e-16 ***
ORIGIN_SZJESZ05      -2.0198990  0.0124785  -161.871  &lt; 2e-16 ***
ORIGIN_SZJESZ06       0.3575170  0.0042944    83.252  &lt; 2e-16 ***
ORIGIN_SZJESZ07      -1.6621884  0.0097460  -170.551  &lt; 2e-16 ***
ORIGIN_SZJESZ08      -0.5932612  0.0084663   -70.073  &lt; 2e-16 ***
ORIGIN_SZJESZ09       0.5925892  0.0043746   135.461  &lt; 2e-16 ***
ORIGIN_SZJESZ10      -1.8924880  0.0174179  -108.652  &lt; 2e-16 ***
ORIGIN_SZJESZ11      -1.9494598  0.0176831  -110.244  &lt; 2e-16 ***
ORIGIN_SZJWSZ01       0.3394748  0.0055917    60.710  &lt; 2e-16 ***
ORIGIN_SZJWSZ02       0.9871657  0.0040137   245.951  &lt; 2e-16 ***
ORIGIN_SZJWSZ03       1.3116842  0.0037865   346.408  &lt; 2e-16 ***
ORIGIN_SZJWSZ04       1.4409361  0.0038104   378.160  &lt; 2e-16 ***
ORIGIN_SZJWSZ05      -1.2962938  0.0110929  -116.858  &lt; 2e-16 ***
ORIGIN_SZJWSZ06      -0.6942117  0.0086716   -80.056  &lt; 2e-16 ***
ORIGIN_SZJWSZ07      -2.0861859  0.0190587  -109.461  &lt; 2e-16 ***
ORIGIN_SZJWSZ08       2.0608945  0.0036750   560.791  &lt; 2e-16 ***
ORIGIN_SZJWSZ09       1.9210325  0.0035020   548.549  &lt; 2e-16 ***
ORIGIN_SZKLSZ01       0.1861622  0.0042348    43.960  &lt; 2e-16 ***
ORIGIN_SZKLSZ02      -0.4126464  0.0052718   -78.274  &lt; 2e-16 ***
ORIGIN_SZKLSZ03      -0.4642349  0.0053629   -86.564  &lt; 2e-16 ***
ORIGIN_SZKLSZ04      -1.6472371  0.0075251  -218.898  &lt; 2e-16 ***
ORIGIN_SZKLSZ05      -0.5708721  0.0062611   -91.177  &lt; 2e-16 ***
ORIGIN_SZKLSZ06      -0.6135657  0.0050198  -122.229  &lt; 2e-16 ***
ORIGIN_SZKLSZ07      -0.9244714  0.0065291  -141.592  &lt; 2e-16 ***
ORIGIN_SZKLSZ08      -0.8401489  0.0057370  -146.444  &lt; 2e-16 ***
ORIGIN_SZKLSZ09      -1.5444388  0.0071838  -214.990  &lt; 2e-16 ***
ORIGIN_SZLKSZ01      -3.0494346  0.0325902   -93.569  &lt; 2e-16 ***
ORIGIN_SZMDSZ01      -2.2868314  0.0220628  -103.651  &lt; 2e-16 ***
ORIGIN_SZMDSZ02      -0.9137134  0.0097759   -93.466  &lt; 2e-16 ***
ORIGIN_SZMDSZ03      -1.7586473  0.0142443  -123.463  &lt; 2e-16 ***
ORIGIN_SZMPSZ01      -0.7419447  0.0063753  -116.377  &lt; 2e-16 ***
ORIGIN_SZMPSZ02      -0.4050732  0.0056898   -71.193  &lt; 2e-16 ***
ORIGIN_SZMPSZ03       0.4346351  0.0042583   102.068  &lt; 2e-16 ***
ORIGIN_SZMSSZ01      -5.2495941  0.2582191   -20.330  &lt; 2e-16 ***
ORIGIN_SZMUSZ01      -1.2678040  0.0063125  -200.840  &lt; 2e-16 ***
ORIGIN_SZMUSZ02      -3.3941228  0.0181446  -187.060  &lt; 2e-16 ***
ORIGIN_SZMUSZ03      -1.8579872  0.0074767  -248.504  &lt; 2e-16 ***
ORIGIN_SZNTSZ01      -2.4562677  0.0264751   -92.776  &lt; 2e-16 ***
ORIGIN_SZNTSZ02      -2.6884752  0.0153396  -175.264  &lt; 2e-16 ***
ORIGIN_SZNTSZ03      -1.0302618  0.0068333  -150.770  &lt; 2e-16 ***
ORIGIN_SZNTSZ05      -2.9961746  0.0381225   -78.593  &lt; 2e-16 ***
ORIGIN_SZNTSZ06      -3.3551771  0.0417904   -80.286  &lt; 2e-16 ***
ORIGIN_SZNVSZ01       0.6548294  0.0038395   170.550  &lt; 2e-16 ***
ORIGIN_SZNVSZ02      -0.5361729  0.0053627   -99.982  &lt; 2e-16 ***
ORIGIN_SZNVSZ03      -1.0528922  0.0064538  -163.143  &lt; 2e-16 ***
ORIGIN_SZNVSZ04      -1.3383009  0.0079171  -169.040  &lt; 2e-16 ***
ORIGIN_SZNVSZ05      -2.5755709  0.0143828  -179.073  &lt; 2e-16 ***
ORIGIN_SZORSZ01      -3.4038604  0.0362979   -93.776  &lt; 2e-16 ***
ORIGIN_SZORSZ02      -1.3352616  0.0065130  -205.014  &lt; 2e-16 ***
ORIGIN_SZORSZ03      -1.7228462  0.0075332  -228.701  &lt; 2e-16 ***
ORIGIN_SZOTSZ01      -1.8259642  0.0081642  -223.656  &lt; 2e-16 ***
ORIGIN_SZOTSZ02      -1.9274035  0.0094612  -203.716  &lt; 2e-16 ***
ORIGIN_SZOTSZ03      -0.8068808  0.0057451  -140.446  &lt; 2e-16 ***
ORIGIN_SZOTSZ04      -0.7938441  0.0094022   -84.431  &lt; 2e-16 ***
ORIGIN_SZPGSZ01      -0.5451306  0.0094909   -57.437  &lt; 2e-16 ***
ORIGIN_SZPGSZ02      -0.2400242  0.0059692   -40.210  &lt; 2e-16 ***
ORIGIN_SZPGSZ03       1.1781038  0.0038895   302.891  &lt; 2e-16 ***
ORIGIN_SZPGSZ04       1.2997193  0.0038963   333.574  &lt; 2e-16 ***
ORIGIN_SZPGSZ05       0.5404565  0.0048535   111.354  &lt; 2e-16 ***
ORIGIN_SZPLSZ01      -0.4447610  0.0083123   -53.506  &lt; 2e-16 ***
ORIGIN_SZPLSZ02      -1.3630166  0.0119901  -113.678  &lt; 2e-16 ***
ORIGIN_SZPLSZ03      -2.9111192  0.0335677   -86.724  &lt; 2e-16 ***
ORIGIN_SZPLSZ04      -2.9020672  0.0287202  -101.046  &lt; 2e-16 ***
ORIGIN_SZPLSZ05      -2.1070875  0.0177181  -118.923  &lt; 2e-16 ***
ORIGIN_SZPNSZ01       1.7044819  0.0039993   426.198  &lt; 2e-16 ***
ORIGIN_SZPNSZ02      -0.3996381  0.0098818   -40.442  &lt; 2e-16 ***
ORIGIN_SZPNSZ03      -1.8688060  0.0176893  -105.646  &lt; 2e-16 ***
ORIGIN_SZPNSZ04      -2.4090563  0.0245671   -98.060  &lt; 2e-16 ***
ORIGIN_SZPNSZ05      -1.8954587  0.0204403   -92.731  &lt; 2e-16 ***
ORIGIN_SZPRSZ01      -0.5422839  0.0095462   -56.806  &lt; 2e-16 ***
ORIGIN_SZPRSZ02       1.1918482  0.0040335   295.486  &lt; 2e-16 ***
ORIGIN_SZPRSZ03       0.9182134  0.0040784   225.139  &lt; 2e-16 ***
ORIGIN_SZPRSZ04      -0.0754896  0.0062875   -12.006  &lt; 2e-16 ***
ORIGIN_SZPRSZ05       1.3803696  0.0038600   357.608  &lt; 2e-16 ***
ORIGIN_SZPRSZ06      -0.3836077  0.0070846   -54.147  &lt; 2e-16 ***
ORIGIN_SZPRSZ07      -2.4586327  0.0177702  -138.357  &lt; 2e-16 ***
ORIGIN_SZPRSZ08       0.2233076  0.0053220    41.959  &lt; 2e-16 ***
ORIGIN_SZQTSZ01      -0.3596244  0.0058016   -61.988  &lt; 2e-16 ***
ORIGIN_SZQTSZ02      -0.7359044  0.0055569  -132.431  &lt; 2e-16 ***
ORIGIN_SZQTSZ03      -0.2047480  0.0049272   -41.555  &lt; 2e-16 ***
ORIGIN_SZQTSZ04      -1.1088918  0.0067099  -165.262  &lt; 2e-16 ***
ORIGIN_SZQTSZ05      -0.2193786  0.0049741   -44.104  &lt; 2e-16 ***
ORIGIN_SZQTSZ06      -0.5989957  0.0057358  -104.431  &lt; 2e-16 ***
ORIGIN_SZQTSZ07      -1.4949742  0.0082826  -180.496  &lt; 2e-16 ***
ORIGIN_SZQTSZ08      -0.2098833  0.0051292   -40.919  &lt; 2e-16 ***
ORIGIN_SZQTSZ09      -0.5304994  0.0058250   -91.073  &lt; 2e-16 ***
ORIGIN_SZQTSZ10      -0.4513062  0.0057865   -77.992  &lt; 2e-16 ***
ORIGIN_SZQTSZ11      -1.4758123  0.0090241  -163.540  &lt; 2e-16 ***
ORIGIN_SZQTSZ12      -1.1909691  0.0085136  -139.889  &lt; 2e-16 ***
ORIGIN_SZQTSZ13      -0.2161405  0.0053915   -40.089  &lt; 2e-16 ***
ORIGIN_SZQTSZ14      -1.4897165  0.0083116  -179.233  &lt; 2e-16 ***
ORIGIN_SZQTSZ15      -0.7475059  0.0090160   -82.909  &lt; 2e-16 ***
ORIGIN_SZRCSZ01      -0.6763214  0.0058784  -115.052  &lt; 2e-16 ***
ORIGIN_SZRCSZ02      -2.1255737  0.0156783  -135.574  &lt; 2e-16 ***
ORIGIN_SZRCSZ03      -1.4398312  0.0078670  -183.021  &lt; 2e-16 ***
ORIGIN_SZRCSZ04      -2.3098902  0.0123228  -187.448  &lt; 2e-16 ***
ORIGIN_SZRCSZ05      -2.6229210  0.0136432  -192.252  &lt; 2e-16 ***
ORIGIN_SZRCSZ06      -0.5427172  0.0077544   -69.989  &lt; 2e-16 ***
ORIGIN_SZRCSZ08      -2.6175865  0.0179817  -145.570  &lt; 2e-16 ***
ORIGIN_SZRCSZ09      -1.9917576  0.0131464  -151.506  &lt; 2e-16 ***
ORIGIN_SZRCSZ10      -1.8806794  0.0078372  -239.969  &lt; 2e-16 ***
ORIGIN_SZRVSZ01      -2.7768261  0.0139448  -199.130  &lt; 2e-16 ***
ORIGIN_SZRVSZ02      -1.2333062  0.0074671  -165.166  &lt; 2e-16 ***
ORIGIN_SZRVSZ03      -2.0800981  0.0113272  -183.637  &lt; 2e-16 ***
ORIGIN_SZRVSZ04      -2.2040158  0.0173312  -127.171  &lt; 2e-16 ***
ORIGIN_SZRVSZ05      -2.2885575  0.0135606  -168.765  &lt; 2e-16 ***
ORIGIN_SZSBSZ01       0.8757203  0.0047106   185.903  &lt; 2e-16 ***
ORIGIN_SZSBSZ02      -0.5319076  0.0068813   -77.297  &lt; 2e-16 ***
ORIGIN_SZSBSZ03       1.0955796  0.0040817   268.412  &lt; 2e-16 ***
ORIGIN_SZSBSZ04       0.8238882  0.0047311   174.142  &lt; 2e-16 ***
ORIGIN_SZSBSZ05       0.0021651  0.0057901     0.374    0.708    
ORIGIN_SZSBSZ06      -1.4917643  0.0137998  -108.100  &lt; 2e-16 ***
ORIGIN_SZSBSZ07      -0.6568958  0.0094394   -69.591  &lt; 2e-16 ***
ORIGIN_SZSBSZ08      -0.8439091  0.0096351   -87.587  &lt; 2e-16 ***
ORIGIN_SZSBSZ09      -0.3062645  0.0072204   -42.417  &lt; 2e-16 ***
ORIGIN_SZSESZ02       1.1587214  0.0038963   297.391  &lt; 2e-16 ***
ORIGIN_SZSESZ03       1.3879835  0.0036935   375.788  &lt; 2e-16 ***
ORIGIN_SZSESZ04       1.0521682  0.0042259   248.979  &lt; 2e-16 ***
ORIGIN_SZSESZ05      -0.0563679  0.0051169   -11.016  &lt; 2e-16 ***
ORIGIN_SZSESZ06       1.0449269  0.0040284   259.388  &lt; 2e-16 ***
ORIGIN_SZSESZ07      -2.1818479  0.0150605  -144.872  &lt; 2e-16 ***
ORIGIN_SZSGSZ01      -0.8082824  0.0073357  -110.185  &lt; 2e-16 ***
ORIGIN_SZSGSZ02      -1.0735569  0.0086924  -123.505  &lt; 2e-16 ***
ORIGIN_SZSGSZ03       0.4031502  0.0045448    88.707  &lt; 2e-16 ***
ORIGIN_SZSGSZ04       0.3063486  0.0042751    71.659  &lt; 2e-16 ***
ORIGIN_SZSGSZ05      -1.6037907  0.0089939  -178.320  &lt; 2e-16 ***
ORIGIN_SZSGSZ06       0.4486464  0.0040600   110.503  &lt; 2e-16 ***
ORIGIN_SZSGSZ07      -0.4958110  0.0053567   -92.558  &lt; 2e-16 ***
ORIGIN_SZSKSZ01      -0.1475886  0.0070814   -20.842  &lt; 2e-16 ***
ORIGIN_SZSKSZ02       0.3170975  0.0052616    60.266  &lt; 2e-16 ***
ORIGIN_SZSKSZ03      -0.3530447  0.0064310   -54.897  &lt; 2e-16 ***
ORIGIN_SZSKSZ04      -2.0946323  0.0205180  -102.087  &lt; 2e-16 ***
ORIGIN_SZSKSZ05      -1.1102428  0.0128651   -86.299  &lt; 2e-16 ***
ORIGIN_SZSLSZ01      -3.0573722  0.0267883  -114.131  &lt; 2e-16 ***
ORIGIN_SZSLSZ04      -0.2972489  0.0062147   -47.830  &lt; 2e-16 ***
ORIGIN_SZSRSZ01      -1.6849783  0.0080871  -208.353  &lt; 2e-16 ***
ORIGIN_SZSRSZ02      -1.9720019  0.0085445  -230.792  &lt; 2e-16 ***
ORIGIN_SZSRSZ03      -2.9317682  0.0175877  -166.694  &lt; 2e-16 ***
ORIGIN_SZSVSZ01      -4.0237287  0.0567990   -70.842  &lt; 2e-16 ***
ORIGIN_SZTHSZ01      -1.7034593  0.0363923   -46.808  &lt; 2e-16 ***
ORIGIN_SZTHSZ03      -1.8014255  0.0161459  -111.572  &lt; 2e-16 ***
ORIGIN_SZTHSZ04      -2.6749725  0.0251164  -106.503  &lt; 2e-16 ***
ORIGIN_SZTHSZ06      -2.1118373  0.0149975  -140.812  &lt; 2e-16 ***
ORIGIN_SZTMSZ01       0.9089892  0.0044890   202.490  &lt; 2e-16 ***
ORIGIN_SZTMSZ02       2.2886581  0.0034149   670.196  &lt; 2e-16 ***
ORIGIN_SZTMSZ03       1.5449408  0.0036605   422.060  &lt; 2e-16 ***
ORIGIN_SZTMSZ04       0.9776313  0.0042051   232.487  &lt; 2e-16 ***
ORIGIN_SZTMSZ05      -0.2459140  0.0065676   -37.443  &lt; 2e-16 ***
ORIGIN_SZTNSZ01      -1.2750694  0.0069422  -183.669  &lt; 2e-16 ***
ORIGIN_SZTNSZ02      -1.1577838  0.0065582  -176.538  &lt; 2e-16 ***
ORIGIN_SZTNSZ03      -1.6369376  0.0087512  -187.054  &lt; 2e-16 ***
ORIGIN_SZTNSZ04      -0.7124953  0.0060485  -117.798  &lt; 2e-16 ***
ORIGIN_SZTPSZ01      -0.6311289  0.0055165  -114.408  &lt; 2e-16 ***
ORIGIN_SZTPSZ02       0.4834100  0.0038860   124.397  &lt; 2e-16 ***
ORIGIN_SZTPSZ03      -0.3605389  0.0053560   -67.315  &lt; 2e-16 ***
ORIGIN_SZTPSZ04      -0.1344543  0.0050550   -26.598  &lt; 2e-16 ***
ORIGIN_SZTPSZ05      -0.1563664  0.0053098   -29.449  &lt; 2e-16 ***
ORIGIN_SZTPSZ06       0.3197379  0.0052926    60.412  &lt; 2e-16 ***
ORIGIN_SZTPSZ07      -0.2970123  0.0057224   -51.904  &lt; 2e-16 ***
ORIGIN_SZTPSZ08      -0.7928670  0.0075233  -105.388  &lt; 2e-16 ***
ORIGIN_SZTPSZ09      -0.4047445  0.0056963   -71.054  &lt; 2e-16 ***
ORIGIN_SZTPSZ10      -0.5375550  0.0061383   -87.574  &lt; 2e-16 ***
ORIGIN_SZTPSZ11       0.2587738  0.0045920    56.353  &lt; 2e-16 ***
ORIGIN_SZTPSZ12      -0.4227318  0.0055987   -75.505  &lt; 2e-16 ***
ORIGIN_SZTSSZ01      -3.7462180  0.0498600   -75.135  &lt; 2e-16 ***
ORIGIN_SZTSSZ02       0.5064375  0.0063176    80.163  &lt; 2e-16 ***
ORIGIN_SZTSSZ03       0.6468062  0.0061046   105.955  &lt; 2e-16 ***
ORIGIN_SZTSSZ04       0.5999365  0.0063391    94.640  &lt; 2e-16 ***
ORIGIN_SZTSSZ05      -0.8635286  0.0117636   -73.407  &lt; 2e-16 ***
ORIGIN_SZTSSZ06      -1.0584223  0.0142616   -74.215  &lt; 2e-16 ***
ORIGIN_SZWCSZ01       0.4620512  0.0058731    78.673  &lt; 2e-16 ***
ORIGIN_SZWCSZ02      -2.6522428  0.0266061   -99.685  &lt; 2e-16 ***
ORIGIN_SZWCSZ03      -4.3371974  0.1291395   -33.585  &lt; 2e-16 ***
ORIGIN_SZWDSZ01       1.4191503  0.0037442   379.023  &lt; 2e-16 ***
ORIGIN_SZWDSZ02       1.2242673  0.0041589   294.371  &lt; 2e-16 ***
ORIGIN_SZWDSZ03       2.2493444  0.0036309   619.501  &lt; 2e-16 ***
ORIGIN_SZWDSZ04       1.2928790  0.0043465   297.453  &lt; 2e-16 ***
ORIGIN_SZWDSZ05       0.7226180  0.0043727   165.257  &lt; 2e-16 ***
ORIGIN_SZWDSZ06       1.2861581  0.0041281   311.564  &lt; 2e-16 ***
ORIGIN_SZWDSZ07      -0.0701950  0.0067852   -10.345  &lt; 2e-16 ***
ORIGIN_SZWDSZ08      -0.0996380  0.0064850   -15.364  &lt; 2e-16 ***
ORIGIN_SZWDSZ09       1.4917032  0.0039823   374.586  &lt; 2e-16 ***
ORIGIN_SZYSSZ01       0.0490751  0.0048619    10.094  &lt; 2e-16 ***
ORIGIN_SZYSSZ02       1.0566018  0.0044148   239.334  &lt; 2e-16 ***
ORIGIN_SZYSSZ03       1.9676617  0.0037548   524.041  &lt; 2e-16 ***
ORIGIN_SZYSSZ04       0.9771122  0.0039924   244.745  &lt; 2e-16 ***
ORIGIN_SZYSSZ05       0.2282429  0.0049480    46.128  &lt; 2e-16 ***
ORIGIN_SZYSSZ06      -0.9726470  0.0088018  -110.506  &lt; 2e-16 ***
ORIGIN_SZYSSZ07      -0.7319012  0.0083972   -87.160  &lt; 2e-16 ***
ORIGIN_SZYSSZ08       0.0291637  0.0054994     5.303 1.14e-07 ***
ORIGIN_SZYSSZ09       1.4942617  0.0038005   393.173  &lt; 2e-16 ***
log(DESTIN_AGE25_64)  0.0234589  0.0000707   331.787  &lt; 2e-16 ***
log(dist)            -0.6993489  0.0001103 -6342.753  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 88920223  on 20599  degrees of freedom
Residual deviance: 38651596  on 20288  degrees of freedom
AIC: 38781345

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3916646</code></pre>
</div>
</div>
</section>
<section id="destination-constrained" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="destination-constrained"><span class="header-section-number">6.7</span> Destination constrained</h2>
<p>In this section, we will fit a destination constrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          10.7508117  0.0030780  3492.796  &lt; 2e-16 ***
DESTIN_SZAMSZ02       0.2839062  0.0038567    73.614  &lt; 2e-16 ***
DESTIN_SZAMSZ03       0.4306927  0.0036823   116.963  &lt; 2e-16 ***
DESTIN_SZAMSZ04      -0.8010799  0.0054756  -146.299  &lt; 2e-16 ***
DESTIN_SZAMSZ05      -0.8583345  0.0052691  -162.901  &lt; 2e-16 ***
DESTIN_SZAMSZ06      -0.6860157  0.0052062  -131.768  &lt; 2e-16 ***
DESTIN_SZAMSZ07      -1.7152580  0.0089336  -192.000  &lt; 2e-16 ***
DESTIN_SZAMSZ08      -0.8492376  0.0058007  -146.402  &lt; 2e-16 ***
DESTIN_SZAMSZ09      -0.8317970  0.0054654  -152.194  &lt; 2e-16 ***
DESTIN_SZAMSZ10       0.5099307  0.0038774   131.514  &lt; 2e-16 ***
DESTIN_SZAMSZ11       0.1433257  0.0066949    21.408  &lt; 2e-16 ***
DESTIN_SZAMSZ12      -0.6777171  0.0061136  -110.854  &lt; 2e-16 ***
DESTIN_SZBDSZ01       0.6856188  0.0034558   198.396  &lt; 2e-16 ***
DESTIN_SZBDSZ02      -0.0655409  0.0044247   -14.813  &lt; 2e-16 ***
DESTIN_SZBDSZ03       0.1531570  0.0038934    39.338  &lt; 2e-16 ***
DESTIN_SZBDSZ04       1.1599806  0.0031908   363.539  &lt; 2e-16 ***
DESTIN_SZBDSZ05       0.5394399  0.0035351   152.596  &lt; 2e-16 ***
DESTIN_SZBDSZ06       0.3393177  0.0038462    88.221  &lt; 2e-16 ***
DESTIN_SZBDSZ07      -0.7852613  0.0077583  -101.216  &lt; 2e-16 ***
DESTIN_SZBDSZ08      -1.5458650  0.0090502  -170.810  &lt; 2e-16 ***
DESTIN_SZBKSZ01      -0.8866839  0.0056112  -158.020  &lt; 2e-16 ***
DESTIN_SZBKSZ02      -0.0327540  0.0046131    -7.100 1.25e-12 ***
DESTIN_SZBKSZ03      -0.3167299  0.0048345   -65.514  &lt; 2e-16 ***
DESTIN_SZBKSZ04       0.2295516  0.0042654    53.817  &lt; 2e-16 ***
DESTIN_SZBKSZ05      -0.5609944  0.0049507  -113.315  &lt; 2e-16 ***
DESTIN_SZBKSZ06      -0.7637541  0.0055115  -138.575  &lt; 2e-16 ***
DESTIN_SZBKSZ07       0.4331355  0.0036382   119.054  &lt; 2e-16 ***
DESTIN_SZBKSZ08      -1.0069862  0.0062984  -159.880  &lt; 2e-16 ***
DESTIN_SZBKSZ09      -0.2172189  0.0045109   -48.154  &lt; 2e-16 ***
DESTIN_SZBLSZ01      -0.0912139  0.0058701   -15.539  &lt; 2e-16 ***
DESTIN_SZBLSZ02       0.8732708  0.0057725   151.282  &lt; 2e-16 ***
DESTIN_SZBLSZ03       1.7218191  0.0063041   273.127  &lt; 2e-16 ***
DESTIN_SZBLSZ04       0.4542678  0.0103798    43.765  &lt; 2e-16 ***
DESTIN_SZBMSZ01      -0.0936209  0.0040616   -23.050  &lt; 2e-16 ***
DESTIN_SZBMSZ02      -0.4635549  0.0043364  -106.898  &lt; 2e-16 ***
DESTIN_SZBMSZ03      -0.8424932  0.0052157  -161.529  &lt; 2e-16 ***
DESTIN_SZBMSZ04      -0.5076746  0.0044861  -113.166  &lt; 2e-16 ***
DESTIN_SZBMSZ05      -0.5555895  0.0053786  -103.297  &lt; 2e-16 ***
DESTIN_SZBMSZ06      -1.6552732  0.0091463  -180.977  &lt; 2e-16 ***
DESTIN_SZBMSZ07      -0.0427226  0.0039367   -10.852  &lt; 2e-16 ***
DESTIN_SZBMSZ08      -1.0921979  0.0053522  -204.067  &lt; 2e-16 ***
DESTIN_SZBMSZ09      -1.9948722  0.0084860  -235.079  &lt; 2e-16 ***
DESTIN_SZBMSZ10      -1.6125986  0.0070605  -228.397  &lt; 2e-16 ***
DESTIN_SZBMSZ11      -1.4946742  0.0065263  -229.022  &lt; 2e-16 ***
DESTIN_SZBMSZ12      -1.0123558  0.0067983  -148.913  &lt; 2e-16 ***
DESTIN_SZBMSZ13      -0.2578843  0.0043222   -59.665  &lt; 2e-16 ***
DESTIN_SZBMSZ14      -1.0339216  0.0068113  -151.796  &lt; 2e-16 ***
DESTIN_SZBMSZ15      -1.1406277  0.0061110  -186.652  &lt; 2e-16 ***
DESTIN_SZBMSZ16      -1.4634801  0.0064078  -228.390  &lt; 2e-16 ***
DESTIN_SZBMSZ17      -1.3751289  0.0075163  -182.954  &lt; 2e-16 ***
DESTIN_SZBPSZ01      -0.4148273  0.0048362   -85.776  &lt; 2e-16 ***
DESTIN_SZBPSZ02      -1.3861009  0.0077314  -179.282  &lt; 2e-16 ***
DESTIN_SZBPSZ03      -1.0828236  0.0071960  -150.475  &lt; 2e-16 ***
DESTIN_SZBPSZ04      -0.5981784  0.0053735  -111.321  &lt; 2e-16 ***
DESTIN_SZBPSZ05       0.6141313  0.0035375   173.608  &lt; 2e-16 ***
DESTIN_SZBPSZ06      -0.6601734  0.0065643  -100.571  &lt; 2e-16 ***
DESTIN_SZBPSZ07      -0.3935848  0.0066280   -59.382  &lt; 2e-16 ***
DESTIN_SZBSSZ01      -0.0779471  0.0040368   -19.309  &lt; 2e-16 ***
DESTIN_SZBSSZ02      -0.6721472  0.0046819  -143.562  &lt; 2e-16 ***
DESTIN_SZBSSZ03       0.2324562  0.0035877    64.793  &lt; 2e-16 ***
DESTIN_SZBTSZ01       0.2200750  0.0037721    58.343  &lt; 2e-16 ***
DESTIN_SZBTSZ02      -0.5608117  0.0056765   -98.796  &lt; 2e-16 ***
DESTIN_SZBTSZ03      -0.1081184  0.0044095   -24.520  &lt; 2e-16 ***
DESTIN_SZBTSZ04      -1.5479561  0.0088245  -175.416  &lt; 2e-16 ***
DESTIN_SZBTSZ05      -0.6457186  0.0060380  -106.943  &lt; 2e-16 ***
DESTIN_SZBTSZ06      -0.8460008  0.0055675  -151.954  &lt; 2e-16 ***
DESTIN_SZBTSZ07      -1.8053654  0.0084483  -213.695  &lt; 2e-16 ***
DESTIN_SZBTSZ08      -1.1682832  0.0073421  -159.122  &lt; 2e-16 ***
DESTIN_SZCBSZ01      -4.7400015  0.2582141   -18.357  &lt; 2e-16 ***
DESTIN_SZCCSZ01      -0.5867665  0.0062887   -93.305  &lt; 2e-16 ***
DESTIN_SZCHSZ01      -0.8917753  0.0076306  -116.868  &lt; 2e-16 ***
DESTIN_SZCHSZ02       0.1715371  0.0047410    36.181  &lt; 2e-16 ***
DESTIN_SZCHSZ03       1.8280462  0.0034465   530.402  &lt; 2e-16 ***
DESTIN_SZCKSZ01      -0.1739151  0.0045215   -38.464  &lt; 2e-16 ***
DESTIN_SZCKSZ02      -0.4063167  0.0048588   -83.624  &lt; 2e-16 ***
DESTIN_SZCKSZ03       0.8036429  0.0035410   226.955  &lt; 2e-16 ***
DESTIN_SZCKSZ04      -0.6240149  0.0056195  -111.045  &lt; 2e-16 ***
DESTIN_SZCKSZ05      -0.2383528  0.0058197   -40.956  &lt; 2e-16 ***
DESTIN_SZCKSZ06       0.6845347  0.0043126   158.727  &lt; 2e-16 ***
DESTIN_SZCLSZ01       0.5974361  0.0042068   142.018  &lt; 2e-16 ***
DESTIN_SZCLSZ02      -2.1086220  0.0116870  -180.425  &lt; 2e-16 ***
DESTIN_SZCLSZ03      -0.9465157  0.0065894  -143.643  &lt; 2e-16 ***
DESTIN_SZCLSZ04       0.1725485  0.0039508    43.674  &lt; 2e-16 ***
DESTIN_SZCLSZ05      -0.9604751  0.0068922  -139.357  &lt; 2e-16 ***
DESTIN_SZCLSZ06       0.1960877  0.0037618    52.126  &lt; 2e-16 ***
DESTIN_SZCLSZ07      -0.5242570  0.0047571  -110.205  &lt; 2e-16 ***
DESTIN_SZCLSZ08      -0.3842675  0.0052616   -73.033  &lt; 2e-16 ***
DESTIN_SZCLSZ09       0.3514013  0.0056529    62.163  &lt; 2e-16 ***
DESTIN_SZDTSZ01      -0.8130081  0.0048754  -166.757  &lt; 2e-16 ***
DESTIN_SZDTSZ02      -0.8759301  0.0048215  -181.671  &lt; 2e-16 ***
DESTIN_SZDTSZ03      -1.0708543  0.0056028  -191.129  &lt; 2e-16 ***
DESTIN_SZDTSZ04      -1.1604903  0.0125653   -92.357  &lt; 2e-16 ***
DESTIN_SZDTSZ05      -1.1549812  0.0088096  -131.105  &lt; 2e-16 ***
DESTIN_SZDTSZ06      -0.9487479  0.0056945  -166.606  &lt; 2e-16 ***
DESTIN_SZDTSZ07      -2.0191431  0.0209759   -96.260  &lt; 2e-16 ***
DESTIN_SZDTSZ08      -0.5381683  0.0043871  -122.671  &lt; 2e-16 ***
DESTIN_SZDTSZ09      -1.3556820  0.0096701  -140.193  &lt; 2e-16 ***
DESTIN_SZDTSZ10      -1.5542147  0.0088951  -174.727  &lt; 2e-16 ***
DESTIN_SZDTSZ11      -0.6089266  0.0047467  -128.285  &lt; 2e-16 ***
DESTIN_SZDTSZ12      -2.5521608  0.0171936  -148.437  &lt; 2e-16 ***
DESTIN_SZDTSZ13      -1.8697206  0.0097461  -191.843  &lt; 2e-16 ***
DESTIN_SZGLSZ01       0.1397666  0.0045185    30.932  &lt; 2e-16 ***
DESTIN_SZGLSZ02      -0.2217141  0.0041878   -52.943  &lt; 2e-16 ***
DESTIN_SZGLSZ03       0.5304130  0.0035148   150.909  &lt; 2e-16 ***
DESTIN_SZGLSZ04       0.4907960  0.0034415   142.610  &lt; 2e-16 ***
DESTIN_SZGLSZ05       0.2788043  0.0035946    77.561  &lt; 2e-16 ***
DESTIN_SZHGSZ01       0.4826879  0.0035262   136.886  &lt; 2e-16 ***
DESTIN_SZHGSZ02      -0.4113845  0.0046526   -88.421  &lt; 2e-16 ***
DESTIN_SZHGSZ03      -1.0125376  0.0057393  -176.422  &lt; 2e-16 ***
DESTIN_SZHGSZ04      -0.1514916  0.0040498   -37.407  &lt; 2e-16 ***
DESTIN_SZHGSZ05      -0.0323397  0.0040499    -7.985 1.40e-15 ***
DESTIN_SZHGSZ06      -0.7391075  0.0050170  -147.321  &lt; 2e-16 ***
DESTIN_SZHGSZ07       0.2844554  0.0037586    75.680  &lt; 2e-16 ***
DESTIN_SZHGSZ08      -0.1749828  0.0042881   -40.806  &lt; 2e-16 ***
DESTIN_SZHGSZ09       0.4955070  0.0043403   114.165  &lt; 2e-16 ***
DESTIN_SZHGSZ10      -2.7987786  0.0247620  -113.027  &lt; 2e-16 ***
DESTIN_SZJESZ01      -0.0761378  0.0045726   -16.651  &lt; 2e-16 ***
DESTIN_SZJESZ02      -0.4302317  0.0047711   -90.174  &lt; 2e-16 ***
DESTIN_SZJESZ03      -0.4321296  0.0050293   -85.923  &lt; 2e-16 ***
DESTIN_SZJESZ04       0.1592126  0.0051327    31.020  &lt; 2e-16 ***
DESTIN_SZJESZ05      -0.7020425  0.0079778   -88.000  &lt; 2e-16 ***
DESTIN_SZJESZ06       0.6242741  0.0036527   170.906  &lt; 2e-16 ***
DESTIN_SZJESZ07      -0.7793636  0.0065103  -119.712  &lt; 2e-16 ***
DESTIN_SZJESZ08      -0.3109043  0.0065040   -47.802  &lt; 2e-16 ***
DESTIN_SZJESZ09      -0.2554383  0.0049023   -52.106  &lt; 2e-16 ***
DESTIN_SZJESZ10       0.8992415  0.0060478   148.688  &lt; 2e-16 ***
DESTIN_SZJESZ11       1.1168547  0.0056855   196.440  &lt; 2e-16 ***
DESTIN_SZJWSZ01      -0.1424355  0.0054897   -25.946  &lt; 2e-16 ***
DESTIN_SZJWSZ02      -0.2002214  0.0047858   -41.836  &lt; 2e-16 ***
DESTIN_SZJWSZ03       0.7300105  0.0036739   198.700  &lt; 2e-16 ***
DESTIN_SZJWSZ04       1.1616312  0.0034095   340.709  &lt; 2e-16 ***
DESTIN_SZJWSZ05       0.0800087  0.0051584    15.510  &lt; 2e-16 ***
DESTIN_SZJWSZ06       0.6147127  0.0047591   129.166  &lt; 2e-16 ***
DESTIN_SZJWSZ07      -0.6893648  0.0215336   -32.013  &lt; 2e-16 ***
DESTIN_SZJWSZ08       0.5683807  0.0041424   137.210  &lt; 2e-16 ***
DESTIN_SZJWSZ09       1.5973619  0.0031439   508.082  &lt; 2e-16 ***
DESTIN_SZKLSZ01      -0.5094948  0.0044060  -115.636  &lt; 2e-16 ***
DESTIN_SZKLSZ02      -0.7449865  0.0051360  -145.052  &lt; 2e-16 ***
DESTIN_SZKLSZ03      -1.1356580  0.0054828  -207.132  &lt; 2e-16 ***
DESTIN_SZKLSZ04      -1.5525737  0.0069498  -223.400  &lt; 2e-16 ***
DESTIN_SZKLSZ05      -0.6957866  0.0061482  -113.169  &lt; 2e-16 ***
DESTIN_SZKLSZ06      -0.9285827  0.0049504  -187.579  &lt; 2e-16 ***
DESTIN_SZKLSZ07      -0.9589297  0.0054404  -176.262  &lt; 2e-16 ***
DESTIN_SZKLSZ08      -0.0678530  0.0040065   -16.936  &lt; 2e-16 ***
DESTIN_SZKLSZ09      -1.8626513  0.0074083  -251.427  &lt; 2e-16 ***
DESTIN_SZLKSZ01      -1.4542602  0.0194246   -74.867  &lt; 2e-16 ***
DESTIN_SZMDSZ01      -0.9192172  0.0151847   -60.536  &lt; 2e-16 ***
DESTIN_SZMDSZ02      -0.8522560  0.0093758   -90.900  &lt; 2e-16 ***
DESTIN_SZMDSZ03      -2.6273864  0.0214513  -122.482  &lt; 2e-16 ***
DESTIN_SZMPSZ01      -0.9379593  0.0063215  -148.375  &lt; 2e-16 ***
DESTIN_SZMPSZ02      -0.7981714  0.0053387  -149.507  &lt; 2e-16 ***
DESTIN_SZMPSZ03      -0.1191620  0.0042521   -28.024  &lt; 2e-16 ***
DESTIN_SZMSSZ01      -2.9730915  0.0754302   -39.415  &lt; 2e-16 ***
DESTIN_SZMUSZ01      -1.0785729  0.0052588  -205.101  &lt; 2e-16 ***
DESTIN_SZMUSZ02      -1.4877511  0.0081593  -182.338  &lt; 2e-16 ***
DESTIN_SZMUSZ03      -1.0837736  0.0051775  -209.324  &lt; 2e-16 ***
DESTIN_SZNTSZ01      -2.5074846  0.0218327  -114.850  &lt; 2e-16 ***
DESTIN_SZNTSZ02      -1.8703553  0.0091058  -205.403  &lt; 2e-16 ***
DESTIN_SZNTSZ03      -1.3513958  0.0071426  -189.201  &lt; 2e-16 ***
DESTIN_SZNTSZ05      -1.5793542  0.0168031   -93.992  &lt; 2e-16 ***
DESTIN_SZNTSZ06      -2.7003589  0.0268534  -100.559  &lt; 2e-16 ***
DESTIN_SZNVSZ01      -0.2140522  0.0039151   -54.674  &lt; 2e-16 ***
DESTIN_SZNVSZ02      -0.4851324  0.0045238  -107.240  &lt; 2e-16 ***
DESTIN_SZNVSZ03      -0.4257921  0.0045722   -93.126  &lt; 2e-16 ***
DESTIN_SZNVSZ04      -2.1052751  0.0096396  -218.398  &lt; 2e-16 ***
DESTIN_SZNVSZ05      -1.6948981  0.0076603  -221.258  &lt; 2e-16 ***
DESTIN_SZORSZ01      -1.8510778  0.0180727  -102.424  &lt; 2e-16 ***
DESTIN_SZORSZ02      -0.1325546  0.0040307   -32.886  &lt; 2e-16 ***
DESTIN_SZORSZ03      -0.8855850  0.0051670  -171.392  &lt; 2e-16 ***
DESTIN_SZOTSZ01      -1.5251208  0.0066865  -228.089  &lt; 2e-16 ***
DESTIN_SZOTSZ02      -0.8893178  0.0060551  -146.871  &lt; 2e-16 ***
DESTIN_SZOTSZ03      -1.5823759  0.0066067  -239.510  &lt; 2e-16 ***
DESTIN_SZOTSZ04      -1.6701028  0.0095617  -174.666  &lt; 2e-16 ***
DESTIN_SZPGSZ01      -1.7562724  0.0139239  -126.133  &lt; 2e-16 ***
DESTIN_SZPGSZ02      -0.6209739  0.0056497  -109.913  &lt; 2e-16 ***
DESTIN_SZPGSZ03       0.5832303  0.0036165   161.267  &lt; 2e-16 ***
DESTIN_SZPGSZ04       0.2924833  0.0039200    74.613  &lt; 2e-16 ***
DESTIN_SZPGSZ05      -0.7690434  0.0064170  -119.844  &lt; 2e-16 ***
DESTIN_SZPLSZ01       0.2997902  0.0055417    54.097  &lt; 2e-16 ***
DESTIN_SZPLSZ02      -1.0305355  0.0105925   -97.289  &lt; 2e-16 ***
DESTIN_SZPLSZ03       0.2818253  0.0079191    35.588  &lt; 2e-16 ***
DESTIN_SZPLSZ04       0.0989608  0.0077745    12.729  &lt; 2e-16 ***
DESTIN_SZPLSZ05      -0.2624956  0.0092023   -28.525  &lt; 2e-16 ***
DESTIN_SZPNSZ01       1.3772685  0.0043673   315.362  &lt; 2e-16 ***
DESTIN_SZPNSZ02       1.9525185  0.0056085   348.134  &lt; 2e-16 ***
DESTIN_SZPNSZ03       1.2700161  0.0063573   199.772  &lt; 2e-16 ***
DESTIN_SZPNSZ04       2.2086756  0.0062030   356.066  &lt; 2e-16 ***
DESTIN_SZPNSZ05       1.4553783  0.0085471   170.278  &lt; 2e-16 ***
DESTIN_SZPRSZ01      -0.5228441  0.0064447   -81.128  &lt; 2e-16 ***
DESTIN_SZPRSZ02       0.0065446  0.0044295     1.477 0.139545    
DESTIN_SZPRSZ03       0.8821825  0.0034383   256.578  &lt; 2e-16 ***
DESTIN_SZPRSZ04      -0.6920045  0.0076043   -91.001  &lt; 2e-16 ***
DESTIN_SZPRSZ05       0.0507562  0.0042404    11.970  &lt; 2e-16 ***
DESTIN_SZPRSZ06       0.6309197  0.0043312   145.668  &lt; 2e-16 ***
DESTIN_SZPRSZ07      -1.2821533  0.0101052  -126.881  &lt; 2e-16 ***
DESTIN_SZPRSZ08      -0.6843269  0.0059022  -115.944  &lt; 2e-16 ***
DESTIN_SZQTSZ01      -1.2525523  0.0081381  -153.912  &lt; 2e-16 ***
DESTIN_SZQTSZ02      -1.5681959  0.0069703  -224.982  &lt; 2e-16 ***
DESTIN_SZQTSZ03      -0.7787760  0.0057643  -135.104  &lt; 2e-16 ***
DESTIN_SZQTSZ04      -1.0473387  0.0060114  -174.226  &lt; 2e-16 ***
DESTIN_SZQTSZ05      -0.8815205  0.0052731  -167.173  &lt; 2e-16 ***
DESTIN_SZQTSZ06      -1.1493379  0.0057253  -200.746  &lt; 2e-16 ***
DESTIN_SZQTSZ07      -1.5539842  0.0092974  -167.142  &lt; 2e-16 ***
DESTIN_SZQTSZ08       0.0928777  0.0041608    22.322  &lt; 2e-16 ***
DESTIN_SZQTSZ09      -0.3353896  0.0050415   -66.526  &lt; 2e-16 ***
DESTIN_SZQTSZ10      -0.3990969  0.0046792   -85.291  &lt; 2e-16 ***
DESTIN_SZQTSZ11      -0.0806971  0.0049649   -16.254  &lt; 2e-16 ***
DESTIN_SZQTSZ12      -0.4606107  0.0060190   -76.527  &lt; 2e-16 ***
DESTIN_SZQTSZ13       0.1940072  0.0042970    45.149  &lt; 2e-16 ***
DESTIN_SZQTSZ14      -0.1783727  0.0050797   -35.114  &lt; 2e-16 ***
DESTIN_SZQTSZ15       0.1084255  0.0059041    18.364  &lt; 2e-16 ***
DESTIN_SZRCSZ01      -1.1732262  0.0060989  -192.368  &lt; 2e-16 ***
DESTIN_SZRCSZ02      -2.2135068  0.0150343  -147.231  &lt; 2e-16 ***
DESTIN_SZRCSZ03      -1.1395391  0.0079216  -143.852  &lt; 2e-16 ***
DESTIN_SZRCSZ04      -2.3798289  0.0110853  -214.683  &lt; 2e-16 ***
DESTIN_SZRCSZ05      -2.4891197  0.0115091  -216.275  &lt; 2e-16 ***
DESTIN_SZRCSZ06      -2.0397389  0.0131477  -155.140  &lt; 2e-16 ***
DESTIN_SZRCSZ08      -2.2566897  0.0126788  -177.990  &lt; 2e-16 ***
DESTIN_SZRCSZ09      -1.4310004  0.0099334  -144.060  &lt; 2e-16 ***
DESTIN_SZRCSZ10      -1.2078330  0.0057801  -208.963  &lt; 2e-16 ***
DESTIN_SZRVSZ01      -2.0913758  0.0094479  -221.358  &lt; 2e-16 ***
DESTIN_SZRVSZ02      -2.2166304  0.0123002  -180.211  &lt; 2e-16 ***
DESTIN_SZRVSZ03      -2.4427627  0.0109800  -222.473  &lt; 2e-16 ***
DESTIN_SZRVSZ04      -2.1091369  0.0151723  -139.012  &lt; 2e-16 ***
DESTIN_SZRVSZ05      -2.0184883  0.0125160  -161.273  &lt; 2e-16 ***
DESTIN_SZSBSZ01       0.0335638  0.0051219     6.553 5.64e-11 ***
DESTIN_SZSBSZ02      -0.9435645  0.0066889  -141.064  &lt; 2e-16 ***
DESTIN_SZSBSZ03       0.7576159  0.0037726   200.822  &lt; 2e-16 ***
DESTIN_SZSBSZ04       0.3675652  0.0045548    80.699  &lt; 2e-16 ***
DESTIN_SZSBSZ05      -0.6638955  0.0062550  -106.138  &lt; 2e-16 ***
DESTIN_SZSBSZ06      -2.3082636  0.0211679  -109.046  &lt; 2e-16 ***
DESTIN_SZSBSZ07      -0.1514545  0.0132983   -11.389  &lt; 2e-16 ***
DESTIN_SZSBSZ08       1.8338179  0.0042436   432.136  &lt; 2e-16 ***
DESTIN_SZSBSZ09       1.1022037  0.0043139   255.499  &lt; 2e-16 ***
DESTIN_SZSESZ02      -0.0339087  0.0041744    -8.123 4.55e-16 ***
DESTIN_SZSESZ03       0.7788795  0.0033616   231.702  &lt; 2e-16 ***
DESTIN_SZSESZ04      -0.5240149  0.0049127  -106.664  &lt; 2e-16 ***
DESTIN_SZSESZ05      -0.0686358  0.0041639   -16.484  &lt; 2e-16 ***
DESTIN_SZSESZ06      -0.4266809  0.0050952   -83.742  &lt; 2e-16 ***
DESTIN_SZSESZ07      -2.7407810  0.0200848  -136.461  &lt; 2e-16 ***
DESTIN_SZSGSZ01      -0.2224302  0.0050154   -44.349  &lt; 2e-16 ***
DESTIN_SZSGSZ02       0.1570660  0.0045272    34.694  &lt; 2e-16 ***
DESTIN_SZSGSZ03      -0.2264829  0.0042946   -52.737  &lt; 2e-16 ***
DESTIN_SZSGSZ04      -0.2252631  0.0043414   -51.888  &lt; 2e-16 ***
DESTIN_SZSGSZ05      -1.8171433  0.0076843  -236.476  &lt; 2e-16 ***
DESTIN_SZSGSZ06       0.5054953  0.0034431   146.813  &lt; 2e-16 ***
DESTIN_SZSGSZ07      -0.3128598  0.0044256   -70.693  &lt; 2e-16 ***
DESTIN_SZSISZ01      -1.4101423  0.0200736   -70.248  &lt; 2e-16 ***
DESTIN_SZSKSZ01       0.1526154  0.0058959    25.885  &lt; 2e-16 ***
DESTIN_SZSKSZ02       0.1211104  0.0059173    20.467  &lt; 2e-16 ***
DESTIN_SZSKSZ03       0.2275540  0.0050553    45.013  &lt; 2e-16 ***
DESTIN_SZSKSZ04      -0.3210274  0.0122955   -26.109  &lt; 2e-16 ***
DESTIN_SZSKSZ05       0.3847096  0.0093083    41.330  &lt; 2e-16 ***
DESTIN_SZSLSZ01      -0.1436252  0.0066352   -21.646  &lt; 2e-16 ***
DESTIN_SZSLSZ04      -0.3148972  0.0055407   -56.833  &lt; 2e-16 ***
DESTIN_SZSRSZ01      -1.5747785  0.0068734  -229.112  &lt; 2e-16 ***
DESTIN_SZSRSZ02      -1.6885450  0.0085337  -197.868  &lt; 2e-16 ***
DESTIN_SZSRSZ03      -1.6139711  0.0077304  -208.783  &lt; 2e-16 ***
DESTIN_SZSVSZ01      -3.2184815  0.0556290   -57.856  &lt; 2e-16 ***
DESTIN_SZTHSZ01      -2.6973210  0.0331414   -81.388  &lt; 2e-16 ***
DESTIN_SZTHSZ03      -1.5390798  0.0185714   -82.874  &lt; 2e-16 ***
DESTIN_SZTHSZ04      -2.1024995  0.0189657  -110.858  &lt; 2e-16 ***
DESTIN_SZTHSZ06      -0.8460270  0.0105837   -79.937  &lt; 2e-16 ***
DESTIN_SZTMSZ01       0.1402849  0.0045968    30.518  &lt; 2e-16 ***
DESTIN_SZTMSZ02       1.7833663  0.0030328   588.028  &lt; 2e-16 ***
DESTIN_SZTMSZ03       0.8754485  0.0034123   256.559  &lt; 2e-16 ***
DESTIN_SZTMSZ04       0.9274501  0.0034956   265.316  &lt; 2e-16 ***
DESTIN_SZTMSZ05       0.7226247  0.0043728   165.256  &lt; 2e-16 ***
DESTIN_SZTNSZ01      -0.6457759  0.0048959  -131.902  &lt; 2e-16 ***
DESTIN_SZTNSZ02      -1.4352096  0.0063876  -224.688  &lt; 2e-16 ***
DESTIN_SZTNSZ03      -1.4383743  0.0078045  -184.300  &lt; 2e-16 ***
DESTIN_SZTNSZ04      -0.9584041  0.0058061  -165.068  &lt; 2e-16 ***
DESTIN_SZTPSZ01      -0.4238815  0.0047638   -88.980  &lt; 2e-16 ***
DESTIN_SZTPSZ02       0.2302907  0.0034488    66.774  &lt; 2e-16 ***
DESTIN_SZTPSZ03      -0.3633775  0.0048621   -74.736  &lt; 2e-16 ***
DESTIN_SZTPSZ04      -1.5414713  0.0068258  -225.830  &lt; 2e-16 ***
DESTIN_SZTPSZ05      -0.7861832  0.0051257  -153.379  &lt; 2e-16 ***
DESTIN_SZTPSZ06      -0.2306047  0.0059194   -38.958  &lt; 2e-16 ***
DESTIN_SZTPSZ07      -1.6386160  0.0093336  -175.561  &lt; 2e-16 ***
DESTIN_SZTPSZ08      -1.3106086  0.0072787  -180.060  &lt; 2e-16 ***
DESTIN_SZTPSZ09      -0.5340698  0.0053383  -100.045  &lt; 2e-16 ***
DESTIN_SZTPSZ10      -0.6924296  0.0067313  -102.867  &lt; 2e-16 ***
DESTIN_SZTPSZ11      -0.3158488  0.0044419   -71.107  &lt; 2e-16 ***
DESTIN_SZTPSZ12      -0.7151984  0.0054086  -132.234  &lt; 2e-16 ***
DESTIN_SZTSSZ01      -0.1883136  0.0187109   -10.064  &lt; 2e-16 ***
DESTIN_SZTSSZ02       1.2720953  0.0077141   164.904  &lt; 2e-16 ***
DESTIN_SZTSSZ03       2.0485658  0.0055935   366.243  &lt; 2e-16 ***
DESTIN_SZTSSZ04       1.9173638  0.0058152   329.716  &lt; 2e-16 ***
DESTIN_SZTSSZ05       2.0478832  0.0064392   318.035  &lt; 2e-16 ***
DESTIN_SZTSSZ06       0.9996676  0.0109281    91.477  &lt; 2e-16 ***
DESTIN_SZWCSZ01       1.6566251  0.0040593   408.110  &lt; 2e-16 ***
DESTIN_SZWCSZ02      -0.1337229  0.0102862   -13.000  &lt; 2e-16 ***
DESTIN_SZWCSZ03      -1.5155595  0.0236971   -63.956  &lt; 2e-16 ***
DESTIN_SZWDSZ01       1.6938928  0.0032123   527.312  &lt; 2e-16 ***
DESTIN_SZWDSZ02      -0.1405706  0.0050461   -27.857  &lt; 2e-16 ***
DESTIN_SZWDSZ03       1.3476314  0.0033673   400.210  &lt; 2e-16 ***
DESTIN_SZWDSZ04       0.2668170  0.0048596    54.905  &lt; 2e-16 ***
DESTIN_SZWDSZ05       0.3366466  0.0045944    73.273  &lt; 2e-16 ***
DESTIN_SZWDSZ06       0.6682970  0.0036977   180.731  &lt; 2e-16 ***
DESTIN_SZWDSZ07       0.7006826  0.0057454   121.956  &lt; 2e-16 ***
DESTIN_SZWDSZ08       0.9495662  0.0052819   179.778  &lt; 2e-16 ***
DESTIN_SZWDSZ09       0.5927500  0.0042996   137.861  &lt; 2e-16 ***
DESTIN_SZYSSZ01       1.3383786  0.0034421   388.830  &lt; 2e-16 ***
DESTIN_SZYSSZ02       0.3970016  0.0043812    90.616  &lt; 2e-16 ***
DESTIN_SZYSSZ03      -0.0171852  0.0047699    -3.603 0.000315 ***
DESTIN_SZYSSZ04       0.1891383  0.0043696    43.285  &lt; 2e-16 ***
DESTIN_SZYSSZ05      -1.4775725  0.0091390  -161.678  &lt; 2e-16 ***
DESTIN_SZYSSZ06      -1.1722834  0.0071348  -164.305  &lt; 2e-16 ***
DESTIN_SZYSSZ07      -0.7639462  0.0086822   -87.990  &lt; 2e-16 ***
DESTIN_SZYSSZ08       0.7418545  0.0035755   207.485  &lt; 2e-16 ***
DESTIN_SZYSSZ09       0.5270666  0.0036041   146.240  &lt; 2e-16 ***
log(ORIGIN_AGE25_64)  0.2391762  0.0001138  2101.866  &lt; 2e-16 ***
log(dist)            -0.6979943  0.0001106 -6309.151  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 88920223  on 20599  degrees of freedom
Residual deviance: 37360814  on 20287  degrees of freedom
AIC: 37490565

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4941146</code></pre>
</div>
</div>
</section>
<section id="doubly-constrained" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="doubly-constrained"><span class="header-section-number">6.8</span> Doubly constrained</h2>
<p>In this section, we will fit a doubly constrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     12.4966116  0.0040561  3080.959  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  1.0591892  0.0040650   260.566  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.6130821  0.0041126   149.074  &lt; 2e-16 ***
ORIGIN_SZAMSZ04  0.2235346  0.0045736    48.875  &lt; 2e-16 ***
ORIGIN_SZAMSZ05  0.0825570  0.0052302    15.785  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.6095542  0.0047519   128.276  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.8250814  0.0079464  -103.830  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.6897281  0.0075825   -90.963  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.4219445  0.0049855    84.634  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.1530905  0.0046439    32.966  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.5715669  0.0100585  -156.242  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.4782210  0.0096093  -153.832  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8344952  0.0040176   207.710  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.4468657  0.0046179    96.769  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.8343032  0.0041581   200.645  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4642964  0.0036148   405.086  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.5926392  0.0040716   145.553  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.8071845  0.0041884   192.721  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -0.6447845  0.0070076   -92.012  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.4406402  0.0065496   -67.277  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.0659897  0.0056721   -11.634  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.6190497  0.0047238   131.049  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  1.0464558  0.0044144   237.055  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.0297910  0.0053938    -5.523 3.33e-08 ***
ORIGIN_SZBKSZ05  0.1995998  0.0050725    39.349  &lt; 2e-16 ***
ORIGIN_SZBKSZ06  0.3290048  0.0053212    61.828  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.8008732  0.0041208   194.348  &lt; 2e-16 ***
ORIGIN_SZBKSZ08  0.3487298  0.0047073    74.082  &lt; 2e-16 ***
ORIGIN_SZBKSZ09  0.1381079  0.0050300    27.457  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -1.7067776  0.0107886  -158.202  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.7850036  0.0160510  -173.510  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -5.0990517  0.0360711  -141.361  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.7788039  0.0197493  -140.704  &lt; 2e-16 ***
ORIGIN_SZBMSZ01  0.1187728  0.0045202    26.276  &lt; 2e-16 ***
ORIGIN_SZBMSZ02 -0.9648595  0.0062327  -154.805  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.1834133  0.0051936   -35.316  &lt; 2e-16 ***
ORIGIN_SZBMSZ04  0.2760770  0.0045626    60.509  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -1.0160883  0.0067990  -149.447  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -1.3097202  0.0108482  -120.732  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.3038126  0.0050057   -60.694  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.1441807  0.0049754   -28.979  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -0.7413387  0.0064916  -114.199  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -0.9399698  0.0072094  -130.380  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -0.3872043  0.0057653   -67.162  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -0.6531114  0.0078370   -83.337  &lt; 2e-16 ***
ORIGIN_SZBMSZ13  0.0636722  0.0049635    12.828  &lt; 2e-16 ***
ORIGIN_SZBMSZ14 -0.1469028  0.0058602   -25.068  &lt; 2e-16 ***
ORIGIN_SZBMSZ15  0.1334010  0.0053044    25.149  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -0.9831390  0.0067506  -145.638  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.3930684  0.0100778  -138.231  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.5543338  0.0049890   111.111  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.8629081  0.0055228   156.244  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  1.0972928  0.0051870   211.547  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.8278269  0.0044951   184.162  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.6829375  0.0041755   163.557  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -0.8674808  0.0075597  -114.751  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.6918239  0.0074105   -93.358  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.1057354  0.0047759    22.139  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.3640223  0.0044333    82.110  &lt; 2e-16 ***
ORIGIN_SZBSSZ03  0.2145379  0.0043033    49.854  &lt; 2e-16 ***
ORIGIN_SZBTSZ01  0.0188860  0.0047841     3.948 7.89e-05 ***
ORIGIN_SZBTSZ02 -0.8633190  0.0068644  -125.768  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.1640418  0.0052268   -31.385  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -0.5694930  0.0090625   -62.840  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -1.4640361  0.0097757  -149.762  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -0.6600823  0.0067082   -98.400  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -1.6939543  0.0104882  -161.511  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.0542057  0.0080676  -130.671  &lt; 2e-16 ***
ORIGIN_SZCBSZ01 -2.9074101  0.0461652   -62.978  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -1.5993177  0.0119335  -134.019  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -1.1703372  0.0100471  -116.485  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.7772685  0.0070575  -110.133  &lt; 2e-16 ***
ORIGIN_SZCHSZ03 -0.6231419  0.0054350  -114.654  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.5648311  0.0045197   124.971  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  1.2686283  0.0046707   271.615  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  0.9257081  0.0042287   218.908  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.8271591  0.0044371   411.788  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  1.6302421  0.0054119   301.233  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  1.1137469  0.0060603   183.779  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.5070844  0.0062710   -80.862  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.2081232  0.0112861  -107.046  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -0.5137408  0.0065375   -78.583  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.7776268  0.0041422   187.734  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.6266661  0.0114806  -141.688  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.9035699  0.0038964   231.899  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.0696754  0.0049004   -14.218  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  0.2469137  0.0056403    43.777  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -2.1299674  0.0145335  -146.555  &lt; 2e-16 ***
ORIGIN_SZDTSZ01 -1.4450722  0.0079647  -181.434  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -1.3939014  0.0074637  -186.757  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -2.4394004  0.0135280  -180.322  &lt; 2e-16 ***
ORIGIN_SZDTSZ04 -4.6572723  0.1768256   -26.338  &lt; 2e-16 ***
ORIGIN_SZDTSZ05 -2.8950583  0.0249100  -116.221  &lt; 2e-16 ***
ORIGIN_SZDTSZ06 -2.7742526  0.0184754  -150.159  &lt; 2e-16 ***
ORIGIN_SZDTSZ07 -1.5433376  0.0235496   -65.536  &lt; 2e-16 ***
ORIGIN_SZDTSZ08 -2.3599579  0.0120595  -195.694  &lt; 2e-16 ***
ORIGIN_SZDTSZ09 -2.6811593  0.0239657  -111.875  &lt; 2e-16 ***
ORIGIN_SZDTSZ10 -2.0506237  0.0127305  -161.080  &lt; 2e-16 ***
ORIGIN_SZDTSZ11 -2.0963489  0.0125222  -167.411  &lt; 2e-16 ***
ORIGIN_SZDTSZ12 -3.0477750  0.0258593  -117.860  &lt; 2e-16 ***
ORIGIN_SZDTSZ13 -2.0652921  0.0138673  -148.932  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.3670824  0.0078027  -175.206  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  0.2835701  0.0044426    63.830  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  0.0615525  0.0044253    13.909  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.9877660  0.0037689   262.082  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.6019388  0.0039569   152.125  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.1989262  0.0043547    45.681  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.6818570  0.0042130   161.845  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.5236155  0.0045298   115.593  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  1.0090032  0.0039059   258.328  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.3345356  0.0038615   345.604  &lt; 2e-16 ***
ORIGIN_SZHGSZ06  0.1110314  0.0048343    22.968  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.5727958  0.0041368   138.464  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  0.1603112  0.0047328    33.872  &lt; 2e-16 ***
ORIGIN_SZHGSZ09 -0.6406435  0.0061647  -103.921  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -3.2187296  0.0407331   -79.020  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4863544  0.0045983   105.768  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.3891810  0.0045629    85.293  &lt; 2e-16 ***
ORIGIN_SZJESZ03  0.3693841  0.0048216    76.610  &lt; 2e-16 ***
ORIGIN_SZJESZ04 -0.9603400  0.0074627  -128.686  &lt; 2e-16 ***
ORIGIN_SZJESZ05 -2.0532793  0.0125837  -163.170  &lt; 2e-16 ***
ORIGIN_SZJESZ06  0.2246801  0.0044615    50.359  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.6331881  0.0098351  -166.058  &lt; 2e-16 ***
ORIGIN_SZJESZ08 -0.8499914  0.0087262   -97.407  &lt; 2e-16 ***
ORIGIN_SZJESZ09  0.5248542  0.0045997   114.107  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -2.6985608  0.0178825  -150.905  &lt; 2e-16 ***
ORIGIN_SZJESZ11 -2.9349376  0.0181710  -161.517  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.5047866  0.0059818    84.387  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  1.0282720  0.0042063   244.458  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.1764945  0.0040387   291.308  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.9876482  0.0041158   239.965  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.7693210  0.0112643  -157.074  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.1131983  0.0089465  -124.428  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -1.8273391  0.0196746   -92.878  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  2.0483105  0.0040450   506.384  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.4089728  0.0037777   372.969  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.3013947  0.0043139    69.866  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.2605614  0.0053519   -48.686  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.3382197  0.0054298   -62.289  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -1.3122170  0.0075695  -173.355  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -0.2861753  0.0064395   -44.441  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -0.3291744  0.0050850   -64.734  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -0.6755728  0.0066047  -102.287  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -0.7458262  0.0058126  -128.311  &lt; 2e-16 ***
ORIGIN_SZKLSZ09 -1.2043757  0.0072278  -166.631  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.4758853  0.0330014   -75.024  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.6711363  0.0233340   -71.618  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.9889661  0.0100548   -98.357  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -1.3831414  0.0145172   -95.276  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.6396094  0.0064787   -98.725  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -0.4095659  0.0057738   -70.935  &lt; 2e-16 ***
ORIGIN_SZMPSZ03  0.4067326  0.0043621    93.243  &lt; 2e-16 ***
ORIGIN_SZMSSZ01 -4.6286722  0.2589985   -17.871  &lt; 2e-16 ***
ORIGIN_SZMUSZ01 -0.9261260  0.0063668  -145.463  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -2.9018719  0.0181864  -159.562  &lt; 2e-16 ***
ORIGIN_SZMUSZ03 -1.5258043  0.0075185  -202.939  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.4615493  0.0264980   -92.896  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -2.2844568  0.0153859  -148.477  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.6904494  0.0069139   -99.864  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -2.6611331  0.0381505   -69.754  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -2.9172586  0.0418365   -69.730  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.8288778  0.0039283   211.002  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.3635060  0.0054460   -66.747  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -0.9540457  0.0065275  -146.158  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -1.1194896  0.0079620  -140.603  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.3859067  0.0144101  -165.572  &lt; 2e-16 ***
ORIGIN_SZORSZ01 -3.0405815  0.0363234   -83.709  &lt; 2e-16 ***
ORIGIN_SZORSZ02 -1.1401169  0.0065821  -173.216  &lt; 2e-16 ***
ORIGIN_SZORSZ03 -1.4185747  0.0075865  -186.986  &lt; 2e-16 ***
ORIGIN_SZOTSZ01 -1.4247675  0.0082304  -173.111  &lt; 2e-16 ***
ORIGIN_SZOTSZ02 -1.6603899  0.0095486  -173.888  &lt; 2e-16 ***
ORIGIN_SZOTSZ03 -0.4211957  0.0058304   -72.241  &lt; 2e-16 ***
ORIGIN_SZOTSZ04 -0.4994803  0.0094838   -52.667  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.7071166  0.0114508    61.753  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.2123053  0.0060914   -34.853  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  1.0455245  0.0040271   259.620  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.1931061  0.0040334   295.807  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.6363361  0.0050325   126.445  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.7135790  0.0086872   -82.142  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.1548170  0.0121923   -94.717  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -3.4630960  0.0341189  -101.501  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.3324952  0.0291243  -114.423  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.2496904  0.0180741  -124.470  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.9405460  0.0049059   191.716  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -1.8465328  0.0112963  -163.463  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.9089806  0.0180972  -160.742  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -4.7301707  0.0253115  -186.878  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -3.6925145  0.0221411  -166.772  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.5249358  0.0098222   -53.444  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  1.0782257  0.0041891   257.391  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.4977909  0.0042287   117.716  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.2699769  0.0065625   -41.139  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  1.1812990  0.0040043   295.005  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -0.8901878  0.0072810  -122.262  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.5604616  0.0178808  -143.196  &lt; 2e-16 ***
ORIGIN_SZPRSZ08  0.0890258  0.0054740    16.263  &lt; 2e-16 ***
ORIGIN_SZQTSZ01  0.1052862  0.0059887    17.581  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.4514716  0.0056346   -80.125  &lt; 2e-16 ***
ORIGIN_SZQTSZ03  0.1069646  0.0050689    21.102  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -0.9495089  0.0068054  -139.524  &lt; 2e-16 ***
ORIGIN_SZQTSZ05  0.0817446  0.0051042    16.015  &lt; 2e-16 ***
ORIGIN_SZQTSZ06 -0.3185567  0.0058467   -54.485  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.2164671  0.0083631  -145.457  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.2117561  0.0052930   -40.007  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.4605864  0.0059518   -77.386  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.3875802  0.0059267   -65.396  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.5553875  0.0091487  -170.013  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -1.1245888  0.0087130  -129.070  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.3370189  0.0055855   -60.338  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.4600821  0.0084380  -173.038  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -1.0779884  0.0095421  -112.972  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -0.3995523  0.0059608   -67.030  &lt; 2e-16 ***
ORIGIN_SZRCSZ02 -1.7210758  0.0157108  -109.547  &lt; 2e-16 ***
ORIGIN_SZRCSZ03 -0.9142324  0.0079829  -114.523  &lt; 2e-16 ***
ORIGIN_SZRCSZ04 -2.1007964  0.0123473  -170.142  &lt; 2e-16 ***
ORIGIN_SZRCSZ05 -2.1111645  0.0136762  -154.368  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.2410605  0.0078163   -30.841  &lt; 2e-16 ***
ORIGIN_SZRCSZ08 -2.3221068  0.0180478  -128.665  &lt; 2e-16 ***
ORIGIN_SZRCSZ09 -1.6764376  0.0131884  -127.115  &lt; 2e-16 ***
ORIGIN_SZRCSZ10 -1.5462202  0.0078842  -196.117  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.4370943  0.0139860  -174.253  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -0.6955044  0.0075706   -91.870  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -1.4716987  0.0113978  -129.122  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -1.7860365  0.0173663  -102.845  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -1.6579974  0.0137611  -120.484  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.9359404  0.0052713   177.555  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.6319837  0.0070303   -89.894  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.6478118  0.0043856   147.713  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.2861251  0.0051894    55.136  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.0305640  0.0060362    -5.063 4.12e-07 ***
ORIGIN_SZSBSZ06 -0.9452297  0.0144662   -65.341  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.1378715  0.0104423   -13.203  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -2.0844986  0.0100784  -206.828  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -1.0748495  0.0075662  -142.059  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.1930123  0.0039974   298.447  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.2049480  0.0037977   317.281  &lt; 2e-16 ***
ORIGIN_SZSESZ04  1.1777460  0.0043780   269.015  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.0832367  0.0052033   -15.997  &lt; 2e-16 ***
ORIGIN_SZSESZ06  1.1917968  0.0041416   287.763  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -1.9359736  0.0150834  -128.351  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.8151091  0.0075068  -108.583  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.2118572  0.0087857  -137.936  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.3946369  0.0046327    85.186  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.3465861  0.0043488    79.697  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.4931536  0.0090229  -165.484  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.3553026  0.0041346    85.933  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.4462510  0.0054204   -82.328  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.1753946  0.0075714   -23.165  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  0.3779065  0.0056560    66.815  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.3212578  0.0066773   -48.112  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -1.8581585  0.0218870   -84.898  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -1.1793751  0.0150179   -78.531  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.9381199  0.0269160  -109.159  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.3155847  0.0063166   -49.961  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -1.2273144  0.0081709  -150.205  &lt; 2e-16 ***
ORIGIN_SZSRSZ02 -1.6090154  0.0085987  -187.123  &lt; 2e-16 ***
ORIGIN_SZSRSZ03 -2.4412686  0.0176806  -138.076  &lt; 2e-16 ***
ORIGIN_SZSVSZ01 -3.1129619  0.0690021   -45.114  &lt; 2e-16 ***
ORIGIN_SZTHSZ01 -2.1289530  0.0364590   -58.393  &lt; 2e-16 ***
ORIGIN_SZTHSZ03 -1.0801473  0.0166302   -64.951  &lt; 2e-16 ***
ORIGIN_SZTHSZ04 -1.8516215  0.0253269   -73.109  &lt; 2e-16 ***
ORIGIN_SZTHSZ06 -1.7604688  0.0151913  -115.887  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  0.5635170  0.0046859   120.259  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.6636315  0.0035612   467.149  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.1602012  0.0038038   305.011  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.3911070  0.0044252    88.382  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -0.8437744  0.0068915  -122.438  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.0103187  0.0070226  -143.866  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -0.8189520  0.0066363  -123.406  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -1.2658087  0.0088503  -143.024  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.3636192  0.0061634   -58.996  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.4389373  0.0056104   -78.236  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5473522  0.0039616   138.165  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.3632655  0.0054591   -66.543  &lt; 2e-16 ***
ORIGIN_SZTPSZ04  0.0466458  0.0051345     9.085  &lt; 2e-16 ***
ORIGIN_SZTPSZ05  0.0824553  0.0054100    15.241  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.7224262  0.0060194   120.017  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.1169830  0.0058182   -20.106  &lt; 2e-16 ***
ORIGIN_SZTPSZ08 -0.4950291  0.0076320   -64.862  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.4442238  0.0058145   -76.400  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -0.3393678  0.0062513   -54.287  &lt; 2e-16 ***
ORIGIN_SZTPSZ11  0.2870061  0.0047070    60.974  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.4042238  0.0056796   -71.172  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -3.9410612  0.0511556   -77.041  &lt; 2e-16 ***
ORIGIN_SZTSSZ02 -0.0022343  0.0082819    -0.270 0.787332    
ORIGIN_SZTSSZ03 -0.2704983  0.0082595   -32.750  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.5507017  0.0085288   -64.570  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -2.5931745  0.0136983  -189.306  &lt; 2e-16 ***
ORIGIN_SZTSSZ06 -2.7760391  0.0207494  -133.789  &lt; 2e-16 ***
ORIGIN_SZWCSZ01 -0.5078672  0.0067651   -75.072  &lt; 2e-16 ***
ORIGIN_SZWCSZ02 -2.5299208  0.0269186   -93.984  &lt; 2e-16 ***
ORIGIN_SZWCSZ03 -4.6346771  0.1291550   -35.885  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  0.8541738  0.0039214   217.823  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  1.0329006  0.0043848   235.565  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.6522935  0.0040199   411.030  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.2237322  0.0047769   256.179  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.5694626  0.0046160   123.367  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.9566450  0.0044185   216.509  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -0.3909105  0.0072005   -54.289  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.6818307  0.0068347   -99.760  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.3698988  0.0043385   315.755  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.3747111  0.0050359   -74.409  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  1.0086870  0.0047931   210.447  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  2.2187630  0.0040347   549.927  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.9550260  0.0041370   230.848  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.4237737  0.0050436    84.022  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.7523568  0.0089087   -84.452  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.6693863  0.0089472   -74.815  &lt; 2e-16 ***
ORIGIN_SZYSSZ08 -0.3390729  0.0056920   -59.570  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.2303208  0.0039904   308.319  &lt; 2e-16 ***
DESTIN_SZAMSZ02  0.0211124  0.0039723     5.315 1.07e-07 ***
DESTIN_SZAMSZ03  0.2839025  0.0037637    75.432  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -0.8165674  0.0055346  -147.540  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -0.7659330  0.0053350  -143.567  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -0.6388567  0.0053423  -119.585  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5321725  0.0089961  -170.315  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.7453204  0.0058831  -126.688  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -0.8793592  0.0055615  -158.117  &lt; 2e-16 ***
DESTIN_SZAMSZ10  0.1891741  0.0039530    47.856  &lt; 2e-16 ***
DESTIN_SZAMSZ11  0.0332095  0.0069001     4.813 1.49e-06 ***
DESTIN_SZAMSZ12 -0.5193169  0.0061739   -84.115  &lt; 2e-16 ***
DESTIN_SZBDSZ01  0.5385493  0.0035894   150.037  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.2415771  0.0045728   -52.829  &lt; 2e-16 ***
DESTIN_SZBDSZ03 -0.0081489  0.0040277    -2.023 0.043049 *  
DESTIN_SZBDSZ04  0.8356118  0.0033244   251.357  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.5067379  0.0036518   138.762  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.1824389  0.0040113    45.481  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.5677255  0.0080202   -70.787  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.6247163  0.0091349  -177.858  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.0749282  0.0057530  -186.847  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.2684365  0.0048881   -54.916  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -0.7390434  0.0050911  -145.164  &lt; 2e-16 ***
DESTIN_SZBKSZ04  0.0429856  0.0045034     9.545  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.5689285  0.0051211  -111.095  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -0.9666944  0.0056965  -169.701  &lt; 2e-16 ***
DESTIN_SZBKSZ07  0.2475196  0.0038359    64.528  &lt; 2e-16 ***
DESTIN_SZBKSZ08 -1.0993626  0.0064539  -170.340  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.2010393  0.0046881   -42.883  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.5082231  0.0060108   -84.552  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.5822129  0.0060119    96.843  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.8426939  0.0066529   276.974  &lt; 2e-16 ***
DESTIN_SZBLSZ04  0.0177787  0.0108489     1.639 0.101265    
DESTIN_SZBMSZ01  0.0231158  0.0041699     5.544 2.96e-08 ***
DESTIN_SZBMSZ02 -0.1955840  0.0044197   -44.253  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.4984387  0.0053297   -93.521  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.2295275  0.0046250   -49.628  &lt; 2e-16 ***
DESTIN_SZBMSZ05 -0.3617358  0.0054770   -66.047  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.1298956  0.0092853  -121.687  &lt; 2e-16 ***
DESTIN_SZBMSZ07  0.2424339  0.0040488    59.878  &lt; 2e-16 ***
DESTIN_SZBMSZ08 -0.7430928  0.0054447  -136.481  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -1.5047569  0.0085633  -175.721  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.1359762  0.0071437  -159.018  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.1661030  0.0066112  -176.383  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.5714995  0.0070389   -81.191  &lt; 2e-16 ***
DESTIN_SZBMSZ13 -0.0101903  0.0044776    -2.276 0.022856 *  
DESTIN_SZBMSZ14 -0.6468292  0.0070776   -91.391  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.8575821  0.0062706  -136.762  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -1.1407169  0.0064702  -176.302  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -1.2126576  0.0075834  -159.909  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -0.7582981  0.0050666  -149.666  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -1.7069485  0.0080434  -212.218  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.5417053  0.0075932  -203.037  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.8858738  0.0055939  -158.365  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.3331327  0.0037543    88.733  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -0.6141779  0.0067549   -90.923  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.3939970  0.0069045   -57.064  &lt; 2e-16 ***
DESTIN_SZBSSZ01  0.1218520  0.0041264    29.530  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.6330208  0.0047460  -133.380  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.3019006  0.0036535    82.633  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.2642613  0.0039100    67.585  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.4948031  0.0058013   -85.292  &lt; 2e-16 ***
DESTIN_SZBTSZ03  0.0840505  0.0045501    18.472  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -1.1158583  0.0091046  -122.560  &lt; 2e-16 ***
DESTIN_SZBTSZ05 -0.3057947  0.0061758   -49.515  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.5868414  0.0056607  -103.670  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.3990897  0.0085073  -164.458  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.6229617  0.0075045   -83.012  &lt; 2e-16 ***
DESTIN_SZCBSZ01 -5.3482386  0.2582193   -20.712  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.5127489  0.0063899   -80.244  &lt; 2e-16 ***
DESTIN_SZCHSZ01 -0.9981867  0.0077439  -128.900  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.0635800  0.0048894    13.004  &lt; 2e-16 ***
DESTIN_SZCHSZ03  1.4572250  0.0036058   404.130  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.4759356  0.0047536  -100.122  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -0.9358143  0.0051724  -180.925  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.2998466  0.0038435    78.013  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -1.5080577  0.0060184  -250.575  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.2133803  0.0067839  -178.862  &lt; 2e-16 ***
DESTIN_SZCKSZ06  0.0434573  0.0056673     7.668 1.75e-14 ***
DESTIN_SZCLSZ01  0.3157994  0.0044183    71.476  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -1.9602455  0.0117882  -166.288  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.7971860  0.0067399  -118.279  &lt; 2e-16 ***
DESTIN_SZCLSZ04  0.0274389  0.0041308     6.642 3.08e-11 ***
DESTIN_SZCLSZ05 -0.6904606  0.0070195   -98.364  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.0716179  0.0039081    18.326  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.3958889  0.0048825   -81.082  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.3482242  0.0055653   -62.570  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.3555632  0.0058816    60.454  &lt; 2e-16 ***
DESTIN_SZDTSZ01 -0.5391452  0.0049347  -109.256  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -0.8194433  0.0048723  -168.183  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -1.0169010  0.0056473  -180.069  &lt; 2e-16 ***
DESTIN_SZDTSZ04 -0.5297146  0.0126795   -41.777  &lt; 2e-16 ***
DESTIN_SZDTSZ05 -0.6473759  0.0088807   -72.897  &lt; 2e-16 ***
DESTIN_SZDTSZ06 -0.8617369  0.0057339  -150.289  &lt; 2e-16 ***
DESTIN_SZDTSZ07 -2.0569281  0.0210230   -97.842  &lt; 2e-16 ***
DESTIN_SZDTSZ08 -0.4136414  0.0044428   -93.103  &lt; 2e-16 ***
DESTIN_SZDTSZ09 -1.5067857  0.0097037  -155.280  &lt; 2e-16 ***
DESTIN_SZDTSZ10 -1.3486238  0.0089622  -150.479  &lt; 2e-16 ***
DESTIN_SZDTSZ11 -0.5241537  0.0048004  -109.190  &lt; 2e-16 ***
DESTIN_SZDTSZ12 -2.5141740  0.0172211  -145.994  &lt; 2e-16 ***
DESTIN_SZDTSZ13 -1.6165616  0.0097938  -165.059  &lt; 2e-16 ***
DESTIN_SZGLSZ01  0.1479855  0.0046141    32.072  &lt; 2e-16 ***
DESTIN_SZGLSZ02 -0.1586055  0.0042851   -37.013  &lt; 2e-16 ***
DESTIN_SZGLSZ03  0.5062282  0.0035978   140.706  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.4383915  0.0035501   123.485  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.2535932  0.0036831    68.853  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.3290666  0.0036058    91.260  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.5820041  0.0047544  -122.414  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.1883737  0.0058266  -203.957  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.3953541  0.0041450   -95.381  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.4396748  0.0041783  -105.229  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.7997170  0.0050828  -157.337  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.1505080  0.0038535    39.057  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -0.2141129  0.0043764   -48.925  &lt; 2e-16 ***
DESTIN_SZHGSZ09  0.1536079  0.0044429    34.574  &lt; 2e-16 ***
DESTIN_SZHGSZ10 -2.8940795  0.0248051  -116.673  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.3084109  0.0047959   -64.307  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.6208815  0.0049320  -125.887  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.5959135  0.0052142  -114.288  &lt; 2e-16 ***
DESTIN_SZJESZ04  0.0187621  0.0053590     3.501 0.000463 ***
DESTIN_SZJESZ05 -0.8506610  0.0080888  -105.166  &lt; 2e-16 ***
DESTIN_SZJESZ06  0.3966194  0.0038268   103.642  &lt; 2e-16 ***
DESTIN_SZJESZ07 -0.8684975  0.0066126  -131.339  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.6327406  0.0067009   -94.426  &lt; 2e-16 ***
DESTIN_SZJESZ09 -0.3483935  0.0051280   -67.940  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.6208771  0.0063329    98.041  &lt; 2e-16 ***
DESTIN_SZJESZ11  0.9376128  0.0059973   156.338  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -0.6611437  0.0059081  -111.905  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.6854325  0.0050264  -136.368  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.3045089  0.0039776    76.556  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.8358144  0.0037186   224.767  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -0.2618105  0.0053072   -49.331  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.0608256  0.0050037   -12.156  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -1.6291742  0.0223242   -72.978  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.5408459  0.0046487  -116.344  &lt; 2e-16 ***
DESTIN_SZJWSZ09  1.0380235  0.0034297   302.658  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.3550389  0.0044935   -79.011  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.6411645  0.0052168  -122.903  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -0.9687060  0.0055471  -174.633  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.3956038  0.0069944  -199.531  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.5944327  0.0063279   -93.938  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -0.6738739  0.0050195  -134.250  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.7250680  0.0055194  -131.367  &lt; 2e-16 ***
DESTIN_SZKLSZ08  0.0506044  0.0040818    12.398  &lt; 2e-16 ***
DESTIN_SZKLSZ09 -1.5569413  0.0074506  -208.968  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.9032642  0.0197063   -96.582  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.2701798  0.0160808   -78.987  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -1.0027039  0.0096162  -104.273  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -2.0744960  0.0218068   -95.131  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.6678281  0.0064335  -103.805  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.6625825  0.0054230  -122.179  &lt; 2e-16 ***
DESTIN_SZMPSZ03 -0.0941854  0.0043707   -21.549  &lt; 2e-16 ***
DESTIN_SZMSSZ01 -0.9964019  0.0759047   -13.127  &lt; 2e-16 ***
DESTIN_SZMUSZ01 -0.9586973  0.0053142  -180.402  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.0473821  0.0082228  -127.375  &lt; 2e-16 ***
DESTIN_SZMUSZ03 -0.9746675  0.0052266  -186.480  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -2.1065137  0.0218706   -96.317  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.5271988  0.0091554  -166.809  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -1.1918868  0.0072221  -165.033  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -1.5100655  0.0168727   -89.498  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -2.7578160  0.0268901  -102.559  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.1773431  0.0040076   -44.252  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.2777875  0.0046110   -60.245  &lt; 2e-16 ***
DESTIN_SZNVSZ03 -0.1938244  0.0046486   -41.695  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.8191107  0.0096864  -187.800  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.3662486  0.0076986  -177.468  &lt; 2e-16 ***
DESTIN_SZORSZ01 -1.2794535  0.0181517   -70.487  &lt; 2e-16 ***
DESTIN_SZORSZ02  0.0844600  0.0041141    20.530  &lt; 2e-16 ***
DESTIN_SZORSZ03 -0.7119874  0.0052319  -136.085  &lt; 2e-16 ***
DESTIN_SZOTSZ01 -1.0673583  0.0067550  -158.009  &lt; 2e-16 ***
DESTIN_SZOTSZ02 -0.4452825  0.0061640   -72.239  &lt; 2e-16 ***
DESTIN_SZOTSZ03 -1.3114902  0.0066812  -196.296  &lt; 2e-16 ***
DESTIN_SZOTSZ04 -1.5702099  0.0095906  -163.723  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -2.1254069  0.0167944  -126.555  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -0.7167814  0.0058167  -123.228  &lt; 2e-16 ***
DESTIN_SZPGSZ03  0.2356549  0.0037783    62.371  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.1175036  0.0040900   -28.730  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -0.9580182  0.0067081  -142.815  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.1294963  0.0058016   -22.321  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.4099592  0.0107774  -130.826  &lt; 2e-16 ***
DESTIN_SZPLSZ03  0.1895489  0.0081365    23.296  &lt; 2e-16 ***
DESTIN_SZPLSZ04  0.1433774  0.0080572    17.795  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.4394746  0.0094286   -46.611  &lt; 2e-16 ***
DESTIN_SZPNSZ01  0.0141183  0.0049800     2.835 0.004583 ** 
DESTIN_SZPNSZ02  1.2411047  0.0065989   188.078  &lt; 2e-16 ***
DESTIN_SZPNSZ03  0.3650063  0.0067099    54.398  &lt; 2e-16 ***
DESTIN_SZPNSZ04  2.1962368  0.0072302   303.758  &lt; 2e-16 ***
DESTIN_SZPNSZ05  1.5501505  0.0097439   159.089  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -0.9220155  0.0066379  -138.901  &lt; 2e-16 ***
DESTIN_SZPRSZ02 -0.3667241  0.0046425   -78.992  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.7089051  0.0035800   198.018  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.6407169  0.0079624   -80.468  &lt; 2e-16 ***
DESTIN_SZPRSZ05 -0.2860877  0.0044367   -64.482  &lt; 2e-16 ***
DESTIN_SZPRSZ06  0.3182073  0.0044782    71.057  &lt; 2e-16 ***
DESTIN_SZPRSZ07 -0.9313994  0.0102139   -91.189  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.7646933  0.0060650  -126.084  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -1.2065568  0.0083953  -143.719  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -1.3337121  0.0070458  -189.292  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.5987814  0.0059454  -100.713  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.6356001  0.0061088  -104.047  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.5632510  0.0054098  -104.116  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.8363928  0.0058291  -143.485  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -1.3223625  0.0093878  -140.860  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.2289320  0.0043088    53.132  &lt; 2e-16 ***
DESTIN_SZQTSZ09 -0.3345250  0.0051666   -64.748  &lt; 2e-16 ***
DESTIN_SZQTSZ10 -0.1951616  0.0048044   -40.621  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.0115878  0.0050805     2.281 0.022558 *  
DESTIN_SZQTSZ12 -0.2601121  0.0061774   -42.107  &lt; 2e-16 ***
DESTIN_SZQTSZ13  0.3029537  0.0044752    67.696  &lt; 2e-16 ***
DESTIN_SZQTSZ14  0.0748386  0.0051987    14.396  &lt; 2e-16 ***
DESTIN_SZQTSZ15  0.1699397  0.0062445    27.215  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.9555784  0.0061856  -154.484  &lt; 2e-16 ***
DESTIN_SZRCSZ02 -2.1248998  0.0150644  -141.055  &lt; 2e-16 ***
DESTIN_SZRCSZ03 -1.0509399  0.0080253  -130.954  &lt; 2e-16 ***
DESTIN_SZRCSZ04 -2.0168192  0.0111212  -181.349  &lt; 2e-16 ***
DESTIN_SZRCSZ05 -2.3217184  0.0115384  -201.217  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -1.7109774  0.0131848  -129.769  &lt; 2e-16 ***
DESTIN_SZRCSZ08 -1.6867983  0.0127613  -132.181  &lt; 2e-16 ***
DESTIN_SZRCSZ09 -1.1288545  0.0099814  -113.096  &lt; 2e-16 ***
DESTIN_SZRCSZ10 -0.8322188  0.0058352  -142.620  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.5874174  0.0094951  -167.183  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -2.0632703  0.0123823  -166.631  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -1.9352774  0.0110428  -175.252  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.6999412  0.0152183  -111.703  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -1.3174869  0.0127063  -103.688  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -0.3511150  0.0058151   -60.380  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -0.9498747  0.0068382  -138.908  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.5963524  0.0041051   145.270  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.3269010  0.0050407    64.852  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -0.6776338  0.0065376  -103.651  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.9663827  0.0221685   -88.702  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -1.4831285  0.0147116  -100.814  &lt; 2e-16 ***
DESTIN_SZSBSZ08  1.4029340  0.0045970   305.186  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.7338341  0.0046211   158.801  &lt; 2e-16 ***
DESTIN_SZSESZ02 -0.4258803  0.0043125   -98.755  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.4320760  0.0034754   124.323  &lt; 2e-16 ***
DESTIN_SZSESZ04 -0.8491377  0.0051131  -166.072  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.2367025  0.0042519   -55.670  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.8003757  0.0052835  -151.487  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.1163233  0.0201115  -154.952  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.0277356  0.0051347    -5.402 6.60e-08 ***
DESTIN_SZSGSZ02 -0.1026582  0.0045921   -22.355  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.3448425  0.0043826   -78.685  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.2064794  0.0044260   -46.652  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -1.6666369  0.0077157  -216.007  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.4539498  0.0035146   129.160  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.3094940  0.0044927   -68.888  &lt; 2e-16 ***
DESTIN_SZSISZ01 -1.0188388  0.0201495   -50.564  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.4087700  0.0063144   -64.736  &lt; 2e-16 ***
DESTIN_SZSKSZ02 -0.4567170  0.0064009   -71.352  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.3040223  0.0053253   -57.090  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -0.7386444  0.0131885   -56.007  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.2172676  0.0109237   -19.889  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.5523676  0.0067386   -81.971  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -0.7667101  0.0056415  -135.906  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.0677345  0.0069517  -153.593  &lt; 2e-16 ***
DESTIN_SZSRSZ02 -1.3470266  0.0085931  -156.757  &lt; 2e-16 ***
DESTIN_SZSRSZ03 -1.4191310  0.0077723  -182.588  &lt; 2e-16 ***
DESTIN_SZSVSZ01 -1.5435777  0.0678577   -22.747  &lt; 2e-16 ***
DESTIN_SZTHSZ01 -3.4835911  0.0332037  -104.916  &lt; 2e-16 ***
DESTIN_SZTHSZ03 -2.0902120  0.0191240  -109.298  &lt; 2e-16 ***
DESTIN_SZTHSZ04 -2.4801866  0.0191471  -129.534  &lt; 2e-16 ***
DESTIN_SZTHSZ06 -1.2131928  0.0107822  -112.518  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.1783623  0.0048238   -36.976  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.3471362  0.0031928   421.928  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.6167721  0.0035826   172.159  &lt; 2e-16 ***
DESTIN_SZTMSZ04  0.8827896  0.0036849   239.570  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.7015166  0.0046013   152.459  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.3854415  0.0049756   -77.466  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.0116640  0.0064636  -156.517  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -0.9969349  0.0079007  -126.183  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -0.8068935  0.0059051  -136.645  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.2217206  0.0048497   -45.719  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.2947652  0.0035258    83.602  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.1506180  0.0049959   -30.148  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.5516087  0.0068909  -225.168  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -0.8425099  0.0052178  -161.469  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.4783177  0.0068485   -69.843  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -1.6185250  0.0094773  -170.779  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.2058772  0.0073927  -163.118  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.2827998  0.0054707   -51.694  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -0.9042380  0.0068526  -131.956  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.2378862  0.0045592   -52.177  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.5943323  0.0054969  -108.121  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -0.4654272  0.0195130   -23.852  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.2867240  0.0096697   -29.652  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.6143718  0.0075850    80.998  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.7160812  0.0077316    92.617  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.5857568  0.0081300   195.050  &lt; 2e-16 ***
DESTIN_SZTSSZ06  1.4138202  0.0162869    86.807  &lt; 2e-16 ***
DESTIN_SZWCSZ01  1.1496497  0.0046986   244.682  &lt; 2e-16 ***
DESTIN_SZWCSZ02 -1.0349742  0.0105727   -97.891  &lt; 2e-16 ***
DESTIN_SZWCSZ03 -2.2963440  0.0237591   -96.651  &lt; 2e-16 ***
DESTIN_SZWDSZ01  0.9781536  0.0034040   287.353  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -0.6845793  0.0053438  -128.108  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.6693330  0.0038297   174.774  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.4213882  0.0054825   -76.861  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.0619737  0.0048976   -12.654  &lt; 2e-16 ***
DESTIN_SZWDSZ06  0.2338675  0.0039807    58.750  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -0.2053677  0.0061766   -33.249  &lt; 2e-16 ***
DESTIN_SZWDSZ08  0.1935476  0.0056565    34.217  &lt; 2e-16 ***
DESTIN_SZWDSZ09 -0.2666847  0.0047456   -56.196  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.9922918  0.0036638   270.837  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -0.1925948  0.0048105   -40.037  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -1.1482004  0.0052037  -220.650  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.2303018  0.0045923   -50.149  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.7874160  0.0092880  -192.444  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.2568568  0.0072266  -173.921  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.5479832  0.0092646   -59.148  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.6465652  0.0037043   174.542  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.1198840  0.0037924    31.611  &lt; 2e-16 ***
log(dist)       -0.6772955  0.0001165 -5813.070  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 88920223  on 20599  degrees of freedom
Residual deviance: 29958287  on 19979  degrees of freedom
AIC: 30088654

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5727022</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R^2 value.</p>
</section>
<section id="model-comparison" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">6.9</span> Model comparison</h2>
<p>Another useful model performance measure for continuous dependent variable is <a href="https://towardsdatascience.com/what-does-rmse-really-mean-806b65f2e48e">Root Mean Squared Error</a>. In this sub-section, you will learn how to use <a href="https://easystats.github.io/performance/reference/compare_performance.html"><code>compare_performance()</code></a> of <a href="https://easystats.github.io/performance/index.html"><strong>performance</strong></a> package</p>
<p>First of all, let us create a list called <em>model_list</em> by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the RMSE of all the models in <em>model_list</em> file by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 4652.384
originConstrained      |   glm | 4092.063
destinationConstrained |   glm | 3717.580
doublyConstrained      |   glm | 3548.631</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.</p>
</section>
<section id="visualising-fitted" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="visualising-fitted"><span class="header-section-number">6.10</span> Visualising fitted</h2>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from each model by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will join the values to <em>SIM_data</em> data frame.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Origin Constrained SIM (i.e.&nbsp;orcSIM)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Destination Constrained SIM (i.e.&nbsp;decSIM)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Doubly Constrained SIM (i.e.&nbsp;dbcSIM)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Use patchwork to arrange the plots</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>(unc_p <span class="sc">|</span> orc_p) <span class="sc">/</span> (dec_p <span class="sc">|</span> dbc_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ice3_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>